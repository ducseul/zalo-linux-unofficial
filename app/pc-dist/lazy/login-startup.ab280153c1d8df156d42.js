(this.webpackJsonp=this.webpackJsonp||[]).push([[26],{"0goA":function(e,t,n){"use strict";t.a="assets/logo-new.146dfa01c78183631d33b77999a18288.svg"},"36dD":function(e,t,n){},"47Cz":function(e,t,n){},"4I9T":function(e,t){},BMoG:function(e,t){},Pszc:function(e,t){},U96N:function(e,t,n){},"Xu+P":function(e,t,n){},cy9f:function(e,t,n){},hGpA:function(e,t,n){},o30X:function(e,t){},t3EU:function(e,t,n){},w4sY:function(e,t,n){},xNPa:function(e,t,n){},y65y:function(e,t,n){},yQh1:function(e,t,n){},zn3J:function(e,t,n){"use strict";n.r(t);n("TlRV"),n("m+NF");var o,a=n("J25b"),r=n("jDHv");Object(r.singleton)(a.b)(o=class{getHourNow(){return(new Date).getHours()}getTimeNow(){return Date.now()}getSystemTimeNow(){return Date.now()}});n("bO0B"),n("dhzt"),n("jmmm"),n("GSxB"),n("xDXR"),n("WrSY"),n("LyOm"),n("lNuO"),n("xir9"),n("4Vil"),n("0rWR"),n("Lq8m"),n("EicM"),n("nUpV"),n("5yGw"),n("hRcX"),n("/2rj"),n("gpNb"),n("rhBN"),n("BP4/"),n("cF85"),n("9AEM"),n("fNRA"),n("7g9m");var i,c=n("drXQ"),s=n("Hw41"),l=n("DI/x"),u=n("x9oK"),d=n("xM06"),g=n("Uzj0"),_=n("Mgpg");let y=r.ModuleContainer.injectable()(i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[])(i=class{constructor(){this.logger=void 0,this.installContainer=null;const e=r.ModuleContainer.resolve(_.ZLoggerFactory);this.logger=e.createZLogger("db",["adapter-factory"])}async setupOnce(){return null===this.installContainer&&(this.installContainer=new g.c.Container,(async()=>{try{const e=r.ModuleContainer.resolve(s.b),t=await e.getPort(),n={typeID:d.j,data:{type:d.g,data:{}}};await t.invokeMessage(n),this.logger.zsymb(0,"Z0lr8M","Done clear sessional pools"),this.installContainer.resolve()}catch(e){this.installContainer.reject(e)}})()),this.installContainer.promise}async createAdapter(e,t){if(await this.setupOnce(),t.sessional)throw new l.a(e,"Sessional database adapter is not allowed");return c.a.factory(e,t)}async getExistedPartitionKeys(e){await this.setupOnce();const t=r.ModuleContainer.resolve(s.b),n=await t.getPort(),o={typeID:d.j,data:{type:d.p,data:{fullname:e}}};return n.invokeMessage(o)}})||i)||i)||i;r.ModuleContainer.registerSingleton(u.c,y);n("6Pbj"),n("5lV7"),n("vUp1"),n("xRjI"),n("szdT"),n("Ws6j"),n("mneU"),n("daJc");var m=n("Jq/t"),p=(n("tPRg"),n("dThN"),n("z0WU")),h=(n("XS0u"),n("q1tI")),f=n.n(h),S=n("i8i4"),v=n("Ff2n");function E(){return p.default.getZaloClientID()}var I=n("VTBJ"),N=n("IeCS"),R=n("/PY/"),A=n("ro+J"),b=n("J39W"),w=n("3xbP"),T=n("T2pR"),C=n("Yi2m"),M=n("4prX"),x=n("imka"),O=n("Vp9m"),k=n("KwLe"),D=n("nQja"),L=n("f4Qu");var P=n("Enw1");const Q=f.a.createContext({token:""}),j=()=>f.a.useContext(Q);var K=n("iuhU");let z=function(e){return e.Idle="Idle",e.LoginQR="LoginQR",e.LoginNormal="LoginNormal",e.ForgetPassword="ForgetPassword",e.LoginSuccess="LoginSuccess",e}({}),U=function(e){return e.WaitingScan="WaitingScan",e.TimeoutQR="TimeoutQR",e.WaitingAccept="WaitingAccept",e}({});const B=new Proxy({main_choose_login_qr:"[main][choose-login-qr]",main_choose_login_normal:"[main][choose-login-normal]",main_forget_password:"[main][forget-password]",main_accepted_login:"[main][accepted-login]",qr_scaned:"[qr][scaned]",qr_timeout:"[qr][timeout]",qr_accepted_login:"[qr][accepted-login]",qr_regen_qr:"[qr][regen-qr]"},{get:(e,t,n)=>Reflect.get(e,t,n),set:()=>!1});class q{constructor(){this.key=void 0,this.data=void 0,this.enterTime=void 0,this.exitTime=void 0,this.env=void 0}}class G{constructor(){this.stateKey=void 0,this.parrent=void 0,this.children=void 0}}class W extends q{constructor(e,t,n,o){super(),this.key=e,this.scope=t,this.env=n,this.logger=o,this.data=void 0,this.enterTime=void 0,this.exitTime=void 0,this.data=null,this.enterTime=0,this.exitTime=0}_formatDateTime(e){return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}T${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}Z`}enter(){var e;this.enterTime=Date.now(),null===(e=this.logger)||void 0===e||e.zsymb(0,"ECiKxX",`env="${this.env}" feature="login-v2" scope="${this.scope}" level="info" timestamp="${this._formatDateTime(new Date(this.enterTime))}" state="${this.key}" message="Enter"`)}exit(){var e;this.exitTime=Date.now(),null===(e=this.logger)||void 0===e||e.zsymb(0,"89Ze91",`env="${this.env}" feature="login-v2" scope="${this.scope}" level="info" timestamp="${this._formatDateTime(new Date(this.exitTime))}" state="${this.key}" message="Exit"`)}error(...e){var t;null===(t=this.logger)||void 0===t||t.zsymb(18,"deyY82",`env="${this.env}" feature="login-v2" scope="${this.scope}" level="error" timestamp="${this._formatDateTime(new Date)}" state="${this.key}" message="${e}"`)}noti(...e){var t;null===(t=this.logger)||void 0===t||t.zsymb(0,"hex6Ku",`env="${this.env}" feature="login-v2" scope="${this.scope}" level="warning" timestamp="${this._formatDateTime(new Date)}" state="${this.key}" message="${e}"`)}}class H extends G{constructor(e,t,n){super(),this.logger=n,this.stateKey=void 0,this.action=void 0,this.parrent=void 0,this.children=void 0,this.parrent=e,this.children=null,this.stateKey=U.WaitingScan;const o={};Object.keys(U).forEach((e=>{o[U[e]]=new W(U[e],"login-qr-screen",t,this.logger)})),this.action=Object(I.a)({},o)}get state(){return this.action[this.stateKey]}transaction(e){this.action[this.stateKey].exit(),this.stateKey=e,this.action[this.stateKey].enter()}handler(e){let t=null;switch(e){case B.qr_scaned:this.stateKey===U.WaitingScan&&(t=U.WaitingAccept);break;case B.qr_timeout:this.stateKey!==U.WaitingScan&&this.stateKey!==U.WaitingAccept||(t=U.TimeoutQR);break;case B.qr_regen_qr:this.stateKey===U.TimeoutQR&&(t=U.WaitingScan);break;case B.qr_accepted_login:var n;if(this.stateKey===U.WaitingAccept)t=U.TimeoutQR,null===(n=this.parrent)||void 0===n||n.handler(B.main_accepted_login)}if(t)return this.transaction(t),this.state;throw Error("state or event can not be adapted")}}class F extends G{constructor(e,t){super(),this.logger=t,this.stateKey=void 0,this.action=void 0,this.parrent=void 0,this.children=void 0;const n={};Object.keys(z).forEach((t=>{n[z[t]]=new W(z[t],"login-screen",e,this.logger)})),this.action=Object(I.a)({},n),this.stateKey=z.Idle,this.parrent=null,this.children=(new Map).set("LoginQRStateMachine",new H(this,e,t)),this.action[this.stateKey].enter()}transaction(e){this.action[this.stateKey].exit(),this.stateKey=e,this.action[this.stateKey].enter(),e===z.LoginQR&&this.loginQrState.state.enter()}get state(){return this.action[this.stateKey]}get loginQrState(){var e;const t=null===(e=this.children)||void 0===e?void 0:e.get("LoginQRStateMachine");if(t&&this.children)return t;throw"This children haven't been init"}handler(e){let t=null;switch(e){case B.main_choose_login_qr:this.stateKey!==z.Idle&&this.stateKey!==z.LoginNormal||(t=z.LoginQR);break;case B.main_choose_login_normal:this.stateKey!==z.LoginQR&&this.stateKey!==z.ForgetPassword||(t=z.LoginNormal);break;case B.main_forget_password:this.stateKey===z.LoginNormal&&(t=z.ForgetPassword);break;case B.main_accepted_login:this.stateKey!==z.ForgetPassword&&this.stateKey!==z.LoginNormal&&this.loginQrState.state.key!==U.WaitingAccept||(t=z.LoginSuccess)}if(t)return this.transaction(t),this.state;throw Error("state or event can not be adapted")}}class V{constructor(e,t){this.fn=void 0,this.scheduler=void 0,this.deps=[],this.fn=e,this.scheduler=t}_cleanupEffect(){this.deps.forEach((e=>{e.delete(this)})),this.deps.length=0}run(){this._cleanupEffect(),V.activeEffect=this;const e=this.fn();return V.activeEffect=null,e}}function X(e,t){const n=new V(e,t);return n.run(),n}V.activeEffect=null;const J=new WeakMap;function Z(e,t){if(!V.activeEffect)return;let n=J.get(e);n||(n=new Map,J.set(e,n));let o=n.get(t);o||(o=new Set,n.set(t,o)),o.has(V.activeEffect)||(o.add(V.activeEffect),V.activeEffect.deps.push(o))}const Y=new WeakMap;function $(e){if(Y.has(e))return Y.get(e);const t=new Map,n=new Proxy(e,{get(e,n,o){if(t.has(n))return Z(e,n),t.get(n);{const a=Object.getOwnPropertyDescriptor(e,n);let r=Reflect.get(e,n,a?o:e);return"function"==typeof r?r=r.bind(e):"object"==typeof r&&null!==r&&(r=$(r)),t.set(n,r),Z(e,n),r}},set:(e,n,o,a)=>(t.set(n,o),function(e,t){const n=J.get(e);if(!n)return;const o=n.get(t);o&&new Set(o).forEach((e=>{e.scheduler?e.scheduler():e.run()}))}(e,n),Reflect.set(e,n,o,a))});return Y.set(e,n),n}function ee(e){let t,n=!0;const o=X((()=>{n&&(t=e(),n=!1)}),(()=>n=!0));return{get value(){return n&&o.run(),Z({effectFn:o},"value"),t}}}function te(e){const[,t]=Object(h.useState)({}),n=Object(h.useRef)(e),o=Object(h.useRef)($(n.current)).current;return Object(h.useEffect)((()=>{X((()=>{for(const e in n.current)o[e];t({})}))}),[o]),o}var ne=n("lCMA"),oe=n("zRkS"),ae=n("NGyP"),re=n("iQAb"),ie=n("wudS");function ce(){const e=Object(ie.f)();return Array.isArray(e)?e.join(","):""}const se=({data:e})=>f.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",boxSizing:"border-box",gap:"16px"}},f.a.createElement(ae.a,{size:"xxl",target:Object(I.a)({},e),userId:ce()}),f.a.createElement(re.a,{className:"truncate",style:{fontSize:"16px",fontWeight:"600",lineHeight:"24px",color:"var(--text-primary)"}},e.displayName),f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_AWAIT_ACCEPTED",style:{color:"var(--text-secondary)",width:"90%",textAlign:"center",fontSize:"14px",lineHeight:"20px",fontWeight:400}})),le=()=>f.a.createElement("div",{className:"instructions"},f.a.createElement("span",{key:"qr-login-guide-1",style:{display:"flex",flexDirection:"row",color:"var(--text-primary)",width:"100%",fontSize:"14px",lineHeight:"20px",fontWeight:400,alignItems:"center"}},"1. Â ",f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_GUIDE_1",tagName:"div"})),f.a.createElement("span",{key:"qr-login-guide-2",style:{flexWrap:"wrap",display:"flex",flexDirection:"row",color:"var(--text-primary)",width:"100%",fontSize:"14px",lineHeight:"20px",fontWeight:400,alignItems:"center"}},"2. Â ",f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_GUIDE_2_1",tagName:"div"}),f.a.createElement(oe.a,{icon:"qr_code_20",style:{fontSize:"20px",width:"20px",height:"20px",marginTop:"2px",marginLeft:"1px",marginRight:"1px"}}),f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_GUIDE_2_2",tagName:"div"})),f.a.createElement("span",{key:"qr-login-guide-3",style:{display:"flex",flexDirection:"row",color:"var(--text-primary)",width:"100%",fontSize:"14px",lineHeight:"20px",fontWeight:400,alignItems:"center"}},"3. Â ",f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_GUIDE_3",tagName:"div"}))),ue="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDIiIGhlaWdodD0iNDIiIHZpZXdCb3g9IjAgMCA0MiA0MiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgIGQ9Ik0yNy43MjA3IDMuNTg0M0MzMC4wMDc3IDQuNDY2NjYgMzIuMDk4NiA1Ljc5MDgzIDMzLjg3MzkgNy40ODEyM0MzNS42NDkxIDkuMTcxNjMgMzcuMDc0MSAxMS4xOTUxIDM4LjA2NzQgMTMuNDM2MkMzOS4wNjA2IDE1LjY3NzMgMzkuNjAyNyAxOC4wOTIxIDM5LjY2MjggMjAuNTQyN0MzOS43MjI4IDIyLjk5MzMgMzkuMjk5NSAyNS40MzE4IDM4LjQxNzIgMjcuNzE4OEMzNy41MzQ4IDMwLjAwNTggMzYuMjEwNyAzMi4wOTY3IDM0LjUyMDMgMzMuODcyQzMyLjgyOTkgMzUuNjQ3MyAzMC44MDYzIDM3LjA3MjIgMjguNTY1MiAzOC4wNjU1QzI2LjMyNDIgMzkuMDU4NyAyMy45MDk0IDM5LjYwMDggMjEuNDU4OCAzOS42NjA5QzE5LjAwODIgMzkuNzIwOSAxNi41Njk3IDM5LjI5NzYgMTQuMjgyNyAzOC40MTUzQzExLjk5NTYgMzcuNTMyOSA5LjkwNDggMzYuMjA4OCA4LjEyOTUxIDM0LjUxODRDNi4zNTQyMyAzMi44MjggNC45MjkyOCAzMC44MDQ1IDMuOTM2MDIgMjguNTYzNEMyLjk0Mjc2IDI2LjMyMjMgMi40MDA2NCAyMy45MDc1IDIuMzQwNjIgMjEuNDU2OUMyLjI4MDU5IDE5LjAwNjMgMi43MDM4NCAxNi41Njc4IDMuNTg2MTkgMTQuMjgwOEM0LjQ2ODU1IDExLjk5MzggNS43OTI3MiA5LjkwMjkxIDcuNDgzMTIgOC4xMjc2MkM5LjE3MzUyIDYuMzUyMzQgMTEuMTk3IDQuOTI3MzkgMTMuNDM4MSAzLjkzNDEzQzE1LjY3OTIgMi45NDA4NyAxOC4wOTQgMi4zOTg3NSAyMC41NDQ2IDIuMzM4NzNDMjIuOTk1MiAyLjI3ODcgMjUuNDMzNyAyLjcwMTk1IDI3LjcyMDcgMy41ODQzTDI3LjcyMDcgMy41ODQzWiIKICAgICAgICAgICAgc3Ryb2tlPSIjQzdFMEZGIiBzdHJva2Utd2lkdGg9IjQiIC8+CgogICAgICAgIDxwYXRoCiAgICAgICAgICAgIGQ9Ik0yNy43MjA3IDMuNTg0M0MzMS4zOTg1IDUuMDAzMjIgMzQuNTMyNyA3LjU1MDAyIDM2LjY3NCAxMC44NTk3QzM4LjgxNTQgMTQuMTY5NCAzOS44NTQxIDE4LjA3MiAzOS42NDExIDIyLjAwODMiCiAgICAgICAgICAgIHN0cm9rZT0iIzMzODRGRiIgc3Ryb2tlLXdpZHRoPSI0IiBzdHJva2UtbGluZWNhcD0icm91bmQiIC8+CiAgICAgICAgPGFuaW1hdGVUcmFuc2Zvcm0KICAgICAgICAgICAgYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIgogICAgICAgICAgICBiZWdpbj0iMHMiCiAgICAgICAgICAgIGR1cj0iNjAwbXMiCiAgICAgICAgICAgIHR5cGU9InJvdGF0ZSIKICAgICAgICAgICAgZnJvbT0iMCAyMSAyMSIKICAgICAgICAgICAgdG89IjM2MCAyMSAyMSIKICAgICAgICAgICAgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiCiAgICAgICAgLz4KCiAgICA8L2c+Cjwvc3ZnPg==";var de=n("0goA");function ge(e){var t,n,o,a,r,i;return{base64Qr:null!==(t=null==e?void 0:e.base64_qr)&&void 0!==t?t:"",chkWaitCfirm:null!==(n=null==e?void 0:e.chk_wait_cfirm)&&void 0!==n?n:"",chkWaitScan:null!==(o=null==e?void 0:e.chk_wait_scan)&&void 0!==o?o:"",qrRetry:null!==(a=null==e?void 0:e.qr_retry)&&void 0!==a?a:0,qrTimeout:null!==(r=null==e?void 0:e.qr_timeout)&&void 0!==r?r:0,tokenId:null!==(i=null==e?void 0:e.token_id)&&void 0!==i?i:""}}function _e(e){var t,n;return{avatar:null!==(t=null==e?void 0:e.avatar)&&void 0!==t?t:"",displayName:null!==(n=null==e?void 0:e.display_name)&&void 0!==n?n:""}}var ye=n("c51z");const me={get:(e,t,n)=>Reflect.get(e,t,n),set:()=>!1},pe=new Proxy(ye.a,me);n("Pszc"),n("4I9T");n("o30X"),n("BMoG");var he=n("fBUP"),fe=n("igA5"),Se=n("1pet");const ve=new Proxy(Se,{get:(e,t,n)=>Reflect.get(e,t,n),set:()=>!1});function Ee(){return ve}var Ie=n("X4fA");class Ne{constructor(e){this.value=e,this._tag="Left"}}class Re{constructor(e){this.value=e,this._tag="Right"}}const Ae=e=>new Ne(e),be=e=>new Re(e);class we extends Error{constructor({code:e="STR_ERROR_UNKNOWN",name:t="ErrorApi",message:n="STR_ERROR_UNKNOWN",data:o=null}){super(n),this.code=void 0,this.message=void 0,this.name=void 0,this.data=void 0,this.code=e,this.message=n,this.name=t,this.data=o}}function Te(e){return 0===(null==e?void 0:e.error_code)?be(null==e?void 0:e.data):Ae(new we({code:null==e?void 0:e.error_code,message:null!==(t=null==e?void 0:e.error_message_localize)&&void 0!==t?t:null==e?void 0:e.error_message,data:(null==e?void 0:e.data)||null}));var t}async function*Ce(e,t,n){for(let h=n;h>0;h--)try{var o,a,r,i,c;const n=await he.default.getStatusQRCode(e,t);if(200===(null==n?void 0:n.status)&&null!=n&&null!==(o=n.data)&&void 0!==o&&o.data&&0===(null==n||null===(a=n.data)||void 0===a?void 0:a.error_code))yield{data:n.data.data,error_code:n.data.error_code,error_message:n.data.error_message};else if(200===(null==n?void 0:n.status)&&null!=n&&null!==(r=n.data)&&void 0!==r&&r.data&&-20===(null==n||null===(i=n.data)||void 0===i?void 0:i.error_code))yield{data:n.data.data,error_code:n.data.error_code,error_message:n.data.error_message};else if(200===(null==n?void 0:n.status)&&18010===(null==n||null===(c=n.data)||void 0===c?void 0:c.error_code)){var s,l,u;yield{data:(null==n||null===(s=n.data)||void 0===s?void 0:s.data)||null,error_code:(null==n||null===(l=n.data)||void 0===l?void 0:l.error_code)||n.status,error_message:(null==n||null===(u=n.data)||void 0===u?void 0:u.error_message)||n.statusText}}else{var d,g,_,y,m;if(!(h-1>0))throw{data:(null==n||null===(d=n.data)||void 0===d?void 0:d.data)||null,error_code:(null==n||null===(g=n.data)||void 0===g?void 0:g.error_code)||(null==n||null===(_=n.data)||void 0===_?void 0:_.error)||n.status,error_message:(null==n||null===(y=n.data)||void 0===y?void 0:y.error_message)||(null==n||null===(m=n.data)||void 0===m?void 0:m.errorMsg)||n.statusText};yield null}}catch(p){throw p instanceof Error&&"Network Error"===p.message?new we({code:"STR_CONNECTION_ERROR",message:"STR_CONNECTION_ERROR",name:"Network Error"}):408===p.error_code?new we({code:"STR_LOGIN_QR_PAGE_QR_TIMEOUT_ERROR",message:"STR_LOGIN_QR_PAGE_QR_TIMEOUT_ERROR",name:"408"}):p}}n("yQh1");var Me=n("kEG/");const xe={get:(e,t,n)=>Reflect.get(e,t,n),set:()=>!1},Oe=new Proxy(Me.a,xe),ke=()=>{const e=j(),t=Object(h.useRef)(null),n=Object(h.useRef)(null),o=te({loginQrStateKey:e.stateMachine.loginQrState.state.key,qrData:ge(),previewInfo:_e(),qrGenLimit:!1,countDownQRLimited:89,errorMessage:""}),a=ee((()=>o.loginQrStateKey===U.TimeoutQR||o.qrGenLimit)),r=ee((()=>!(o.loginQrStateKey===U.TimeoutQR||o.qrGenLimit||o.qrData.base64Qr)));async function i(){let t=!1;try{const n=await async function(e,t,n){try{const o=await he.default.getQRCode(e,t,n),a=Te(null==o?void 0:o.data);if("Right"===a._tag)return ge(null==a?void 0:a.value);throw a.value}catch(o){throw o instanceof Error&&"Network Error"===o.message?new we({code:"STR_CONNECTION_ERROR",message:"STR_CONNECTION_ERROR",name:"Network Error"}):o}}(E(),ce(),pe.getCurrentLanguageName());e.stateMachine.loginQrState.state.noti("Get QR code successfully"),c(n),setTimeout((()=>{o.qrData=n}),300),t=!0}catch(r){if(e.stateMachine.loginQrState.state.error(`Get QR code failed : ${JSON.stringify(r)}`),r instanceof we)if("string"==typeof(null==r?void 0:r.code))o.errorMessage=pe.str(r.code);else if(r.code===Oe.REQUEST_RATE_LIMIT_EXCEEDED){var n,a;o.errorMessage=r.message;let e=null!==(n=r.data)&&void 0!==n&&n.time_left&&"number"==typeof(null===(a=r.data)||void 0===a?void 0:a.time_left)?Math.round(r.data.time_left/1e3):89;e+=5-e%5,o.countDownQRLimited=e>20?e:20,o.qrGenLimit=!0}else o.errorMessage=r.message;else o.errorMessage=pe.str("STR_ERROR_UNKNOWN");e.loginSession.loginQrStateStream.next(e.stateMachine.loginQrState.handler(B.qr_timeout))}finally{e.loginSession.logInfoV2Stream.next({type:152402,subType:0,data:{qr_status:t}})}}async function c(t){try{o.previewInfo=await async function(e,t,n){const o=Ce(e,t,n);try{for await(const e of o){if(null===e)continue;const t=Te(e);if("Right"===t._tag)return _e(t.value);throw t.value}}catch(a){throw a}throw new we({})}(t.chkWaitScan,t.qrTimeout,t.qrRetry),e.stateMachine.loginQrState.state.noti("User scan QR successfully"),e.loginSession.loginQrStateStream.next(e.stateMachine.loginQrState.handler(B.qr_scaned))}catch(n){if(n instanceof we)if("string"==typeof(null==n?void 0:n.code))o.errorMessage=pe.str(n.code);else{if(-20===n.code)return o.qrData=ge(n.data),c(o.qrData),void e.stateMachine.loginQrState.state.error("User scan first time successfully but renew QR code in multi layer QR login mode");n.code===Oe.REQUEST_RATE_LIMIT_EXCEEDED?(o.qrGenLimit=!0,o.errorMessage=n.message):o.errorMessage=n.message}else o.errorMessage=pe.str("STR_ERROR_UNKNOWN");e.stateMachine.loginQrState.state.error(`Waiting scan QR failed : ${JSON.stringify(n)}`),e.loginSession.loginQrStateStream.next(e.stateMachine.loginQrState.handler(B.qr_timeout))}}function s(){e.stateMachine.loginQrState.state.noti("User regen new QR after it timeout"),e.loginSession.logInfoV2Stream.next({type:152405,subType:0,data:{}}),e.loginSession.loginQrStateStream.next(e.stateMachine.loginQrState.handler(B.qr_regen_qr))}async function l(){try{const t=await async function(e,t,n){const o=Ce(e,t,n);try{for await(const e of o){if(null===e)continue;const t=Te(e);if("Right"===t._tag){var a,r,i;const e=t.value,n=fe.default.getInstance(),o=null!==(a=null==e?void 0:e.uid)&&void 0!==a?a:"",c=null!==(r=null==e?void 0:e.dkey)&&void 0!==r?r:"";if(o&&c){const e=Object(ie.c)(o);n.init(o,c),e||n.setItemForCurrentUser(Ee().FirstLoginLocalStorageKeys.IS_FIRST_LOGIN,"1")}p.default.extractPhoneInfoAndSaveRecent(e.profile.phonenum)||(n.removeItem(p.RECENT_PHONE),n.removeItem(p.RECENT_COUNTRY));const s=!!e.needSyncMsg||!!e.sync_msg_info;return n.setItem("z_needSyncMsg",s?"1":""),n.setItem(Ee().KEY_REMEMBER,Ie.a.getValueRememberLogin()?"1":""),n.setItem(Ee().KEY_SET_VALUE_ACTION_LOG,`${Ie.a.getValueActionLogRemember()}`),null!=e&&e.cptch_cert&&n.setItem("captcha_cert",e.cptch_cert),n.setItem("FORCE_GET_FRIEND_LIST","1"),await $zelectron.setAppCookie(null!==(i=null==e?void 0:e.zpw_sek)&&void 0!==i?i:""),o}throw t.value}}catch(c){throw c}throw new we({})}(o.qrData.chkWaitCfirm,o.qrData.qrTimeout,o.qrData.qrRetry);e.stateMachine.loginQrState.state.noti("User accept to login QR on mobile"),e.loginSession.loginQrStateStream.next(e.stateMachine.loginQrState.handler(B.qr_accepted_login)),e.stateMachine.state.data={typeLogin:Ee().LOGIN_TYPE_QR},e.loginSession.loginStateStream.next(e.stateMachine.state),e.loginSession.logInfoV2Stream.next({type:152404,subType:0,data:{authentication_status:!0,login_method:"qr",uid:t}})}catch(t){e.stateMachine.loginQrState.state.error(`Waiting confirm login QR from mobile failed: ${JSON.stringify(t)}`),t instanceof we?"string"==typeof(null==t?void 0:t.code)?o.errorMessage=pe.str(t.code):o.errorMessage=t.message:o.errorMessage=pe.str("STR_ERROR_UNKNOWN"),e.loginSession.loginQrStateStream.next(e.stateMachine.loginQrState.handler(B.qr_timeout)),e.loginSession.logInfoV2Stream.next({type:152404,subType:0,data:{authentication_status:!1,login_method:"qr",error_code:(null==t?void 0:t.code)||(null==t?void 0:t.error_code)||t}})}}return Object(h.useEffect)((()=>{e.loginSession.loginQrStateStream.subscribe((e=>{e&&(o.loginQrStateKey=e.key)})),e.loginSession.loginStateStream.subscribe((t=>{if(t&&t.key===z.LoginNormal&&o.loginQrStateKey===U.WaitingScan&&o.errorMessage&&(o.errorMessage=""),t&&o.loginQrStateKey===U.TimeoutQR&&!o.qrGenLimit&&t.key===z.LoginQR)s();else if(t&&t.key===z.LoginQR&&!o.qrGenLimit&&o.loginQrStateKey===U.WaitingScan){var n,a,r;if(null!==(n=t.data)&&void 0!==n&&n.error_from_login_password)o.errorMessage=null!==(a=null===(r=Object(I.a)({},t.data))||void 0===r?void 0:r.error_from_login_password)&&void 0!==a?a:"",e.stateMachine.state.data=null}}))}),[]),Object(h.useEffect)((()=>{if(o.loginQrStateKey===U.WaitingScan){var t,n,a;if(null!==(t=e.stateMachine.state.data)&&void 0!==t&&t.error_from_login_password)o.errorMessage=null!==(n=null===(a=Object(I.a)({},e.stateMachine.state.data))||void 0===a?void 0:a.error_from_login_password)&&void 0!==n?n:"",e.stateMachine.state.data=null;else o.errorMessage="";i()}else o.loginQrStateKey===U.WaitingAccept?l():o.loginQrStateKey===U.TimeoutQR&&(o.previewInfo=_e(),o.qrData=ge())}),[o.loginQrStateKey]),Object(h.useEffect)((()=>{if(o.qrGenLimit){n.current=window.setInterval((()=>{o.countDownQRLimited>0&&o.countDownQRLimited--}),1e3);const e=o.countDownQRLimited;t.current=window.setTimeout((()=>{o.qrGenLimit=!1,o.countDownQRLimited=89,s(),t.current&&window.clearTimeout(t.current),n.current&&window.clearTimeout(n.current)}),1e3*e)}return()=>{t.current&&window.clearTimeout(t.current),n.current&&window.clearTimeout(n.current)}}),[o.qrGenLimit]),f.a.createElement(h.Fragment,null,f.a.createElement("div",{className:"login-qr-page",style:{gap:o.loginQrStateKey===U.WaitingAccept?"60px":void 0}},f.a.createElement("div",{className:"title"},f.a.createElement("img",{draggable:!1,src:de.a,style:{height:"32px",alignSelf:"center"}}),f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_TITLE",style:{margin:"0",color:"var(--text-primary)",fontSize:"18px",lineHeight:"24px",fontWeight:600,alignSelf:"center"},tagName:"div"})),f.a.createElement("div",{className:"qr-scan"},o.loginQrStateKey!==U.WaitingAccept&&f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"login-qr__frame-qr"},f.a.createElement("img",{draggable:!1,className:"qr-image"+(a.value&&!r.value?"--none":""),src:a.value?"data:image/png;base64,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":o.qrData.base64Qr?"data:image/png;base64,"+o.qrData.base64Qr:ue,alt:"QR Code"}),f.a.createElement("div",{className:"mask"+(a.value?"":"--none"),style:{fontSize:"13px",lineHeight:"17px",fontWeight:400,alignSelf:"center",color:"var(--text-primary)",cursor:o.qrGenLimit?"not-allowed":"pointer"},onClick:e=>{e.stopPropagation(),!o.qrGenLimit&&a.value&&s()}},f.a.createElement(oe.a,{style:{fontSize:"var(--f32)",color:o.qrGenLimit?"var(--icon-warning)":"var(--icon-information)"},icon:o.qrGenLimit?"TriangleWarning_24_Filled":"Retry_24_Line"}),f.a.createElement(ne.a,{textKey:o.qrGenLimit?"STR_QR_LIMIT_REACHED":"STR_LOGIN_QR_PAGE_RETRY_GET_QR"})),f.a.createElement("span",{style:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box",padding:"0"}},f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_QR_CODE_TEXT_1",style:{color:"var(--text-information)",fontSize:"13px",lineHeight:"18px",fontWeight:400,alignSelf:"center"}}),f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_QR_CODE_TEXT_2",style:{color:"var(--text-primary)",fontSize:"13px",lineHeight:"18px",fontWeight:400,alignSelf:"center"}}))),f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"70%",height:"fit-content",minHeight:"20px",alignItems:"center"}},f.a.createElement(ne.a,{textKey:`${o.errorMessage}`,tagName:"div",className:"login-error-message"+(o.errorMessage?"":"--none"),style:{textAlign:"center"}}),f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_QR_TIMEOUT_ERROR",tagName:"div",className:"login-error-message"+(!a.value||o.qrGenLimit||o.errorMessage?"--none":"")}),f.a.createElement(ne.a,{textKey:"STR_LOGIN_QR_PAGE_QR_LIMITED_ERROR",textArguments:[`${o.countDownQRLimited}`],tagName:"div",className:"login-error-message"+(a.value&&o.qrGenLimit&&!o.errorMessage?"":"--none")})),o.loginQrStateKey!==U.WaitingAccept&&f.a.createElement(le,null)),o.loginQrStateKey===U.WaitingAccept&&f.a.createElement(se,{data:o.previewInfo}))))};var De=n("v/qp"),Le=n("Ja3U"),Pe=n("XnQq");const Qe={get:(e,t,n)=>Reflect.get(e,t,n),set:(e,t,n)=>Reflect.set(e,t,n)},je=new Proxy(fe.default.getInstance(),Qe);function Ke(){return je}var ze=n("FInY");var Ue=n("wx14"),Be=n("1ZEA");n("Q8hM"),n("xjxT");const qe=e=>{const{domRef:t,onKeyPress:n,className:o,style:a,borderMode:r,needVerify:i=!1,compareValue:c=null,rules:s=[]}=e,[l,u]=f.a.useState(!1),[d,g]=f.a.useState(!1),[_,y]=f.a.useState(!1),[m,h]=f.a.useState("");return f.a.useEffect((()=>{y(p.default.checkValidPassword(m,c||"",s))}),[c]),f.a.createElement("div",{className:"rel z-input flx-1 flx-al-c "+(o||"")+(r?" border-mode ":""),style:a,onClick:()=>{t&&t.focus()}},f.a.createElement(Be.a,Object(Ue.a)({},e,{required:!0,type:l?"text":"password",maxLength:"100",onKeyDown:function(e){if(e){let t=e.getModifierState("CapsLock");t!==d&&g(t)}n&&n(e)},onChange:function(t){var n;e.onChange&&e.onChange(t);let o=null==t||null===(n=t.target)||void 0===n?void 0:n.value;y(p.default.checkValidPassword(o,c||"",s)),h(o)},style:{height:"20px",padding:0,marginRight:"32px"}})),!1,_&&i?f.a.createElement(oe.a,{className:"icon-solid-checked check-pw-icon "}):null,f.a.createElement(oe.a,{icon:l?"Eye_Off_24_Line":"Eye_On_24_Line",className:"toggle-pw-visiblity",style:{width:"24px",height:"24px",fontSize:"24px",position:"absolute",right:"0px",top:"6px"},onClick:e=>{e&&(e.stopPropagation(),e.preventDefault()),u(!l)}}))};n("Xu+P");const Ge=({onEnter:e,onChangeCaptcha:t,isReset:n,isInit:o})=>{const a=Object(h.useRef)(null),r=Object(h.useRef)(null),i=Object(h.useRef)(Number.MAX_SAFE_INTEGER-1),c=Object(h.useRef)(1),s=j(),l=te({captcha:{captchaImg:"",expirationTime:0,token:""},isLoading:!0}),u=Object(h.useCallback)((async()=>{if(null===r.current)try{l.isLoading=!0;const e=await async function(){try{const i=await he.default.getLoginCaptcha(E()),c=Te(null==i?void 0:i.data);var e,t,n,o,a,r;if("Right"===c._tag)return{captchaImg:null!==(e=null==c||null===(t=c.value)||void 0===t?void 0:t.captcha_img)&&void 0!==e?e:"",expirationTime:null!==(n=null==c||null===(o=c.value)||void 0===o?void 0:o.expiration_time)&&void 0!==n?n:0,token:null!==(a=null==c||null===(r=c.value)||void 0===r?void 0:r.token)&&void 0!==a?a:""};throw c.value}catch(i){if(i instanceof Error&&"Network Error"===i.message)throw new we({code:"STR_CONNECTION_ERROR",message:"STR_CONNECTION_ERROR",name:"Network Error"});throw i}}();s.stateMachine.state.noti("Get Captcha successfully"),a.current.value="",t("",""),l.captcha.captchaImg="data:image/png;base64,"+e.captchaImg,l.captcha.token=e.token,l.captcha.expirationTime=e.expirationTime,r.current=window.setInterval((()=>{var e,t;l.captcha.expirationTime>0?l.captcha.expirationTime-=1:(null!==r.current&&window.clearInterval(r.current),r.current=null,i.current=Number.MAX_SAFE_INTEGER-1,(""!==(null==a||null===(e=a.current)||void 0===e?void 0:e.value)||c.current>0)&&(c.current>0&&""===(null==a||null===(t=a.current)||void 0===t?void 0:t.value)&&(c.current-=1),l.captcha.captchaImg="",u()))}),1e3)}catch(e){s.stateMachine.state.error(`Get Captcha was failed: ${e instanceof we?e.message:e}`)}finally{setTimeout((()=>{l.isLoading=!1}),600)}}),[]);function d(){i.current>0&&(i.current--,null!==r.current&&window.clearInterval(r.current),r.current=null,c.current=1,u())}return Object(h.useEffect)((()=>()=>{null!==r.current&&window.clearInterval(r.current)}),[]),Object(h.useEffect)((()=>{n&&d()}),[n]),Object(h.useEffect)((()=>{o&&!n&&d()}),[o]),f.a.createElement("div",{className:Object(K.a)(["z-input","login-normal-page__captcha"]),style:{width:"100%",boxSizing:"border-box",padding:"0",height:"36px"}},f.a.createElement(Be.a,{required:!0,textKey:"STR_INPUT_CAPTCHA",onKeyPress:t=>{e(t)},onChange:e=>{t(e.target.value,l.captcha.token)},type:"text",inputRef:a,style:{padding:"0",boxSizing:"border-box",color:"var(--text-primary)",fontSize:"14px",lineHeight:"20px",fontWeight:400,height:"36px"}}),f.a.createElement("div",{id:"captcha",className:"flx flx-center flx-al-c",style:{width:"fit-content",height:"fit-content",display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",position:"absolute",bottom:"0px",right:"0px"}},f.a.createElement("img",{draggable:!1,src:l.isLoading?ue:l.captcha.captchaImg,alt:"captcha",style:{height:l.isLoading?"20px":"34px"}}),l.isLoading?f.a.createElement("span",{style:{color:"var(--text-placeholder)",fontSize:"14px",lineHeight:"34px",fontWeight:400}},f.a.createElement(ne.a,{textKey:"STR_LOADING"})," ","..."):f.a.createElement(De.a,{icon:"outline-reload",onClick:()=>{d()},type:"tertiary-neutral",size:"large",disabled:0===i.current,style:{width:"24px",height:"24px",minWidth:"24px",minHeight:"24px",padding:"0"}})))};function We(e){var t,n,o,a,r,i,c;return{choices:null!==(t=null==e||null===(n=e.choices)||void 0===n?void 0:n.map((e=>function(e){var t,n,o;return{title:null!==(t=null==e?void 0:e.title)&&void 0!==t?t:"",value:null!==(n=null==e?void 0:e.value)&&void 0!==n?n:"",thumb:null!==(o=null==e?void 0:e.thumb)&&void 0!==o?o:""}}(e))))&&void 0!==t?t:[],content:null!==(o=null==e?void 0:e.content)&&void 0!==o?o:"",questionFormat:null!==(a=null==e?void 0:e.questionFormat)&&void 0!==a?a:0,questionType:null!==(r=null==e?void 0:e.questionType)&&void 0!==r?r:0,answerType:null!==(i=null==e?void 0:e.answerType)&&void 0!==i?i:0,cptchCert:null!==(c=null==e?void 0:e.cptch_cert)&&void 0!==c?c:""}}var He=n("egaF"),Fe=n("O8ue");n("cy9f");function Ve(){const e=Math.round((new Date).getTimezoneOffset()/-60);return(e<0?"":"+")+(e>9?`${e}:00`:`0${e}:00`)}const Xe=({dataSecQues:e,dataUser:t,onBack:n,onSubmit:o,usedForResetPassword:a=!1})=>{var r,i;const c=e.content+` ${ye.a.trans("STR_SECURITY_QUESTION_MESSAGE_SUBTEXT",[(null!==(r=e.answerType)&&void 0!==r?r:0).toString()])}`,s=Object(h.useRef)(null),l=te({checkedItems:new Array(0),messageError:""});async function u(){try{a&&t&&await async function({phone:e,token:t,answerData:n,options:o}){try{const a=E(),r=await he.default.loginByResetPassword(e,a,"","",t,Ve(),o.isoCode,pe.getCurrentLanguageName(),n),i=Te(null==r?void 0:r.data);if("Right"===i._tag)return i.value;throw i.value}catch(a){if(a instanceof Error&&"Network Error"===a.message)throw new we({code:"STR_CONNECTION_ERROR",message:"STR_CONNECTION_ERROR",name:"Network Error"});throw a}}({answerData:{answers:Array.from(l.checkedItems).join(","),answer_type:e.answerType,question_type:e.questionType},options:{isoCode:t.isoCode},phone:t.phone,token:t.token}),await o({answers:Array.from(l.checkedItems).join(","),answer_type:e.answerType,question_type:e.questionType}),n()}catch(r){if(d(),r instanceof we){if(r.code===Oe.OUT_OF_SECQ_QUOTA||r.code===Oe.OUT_OF_SECQ_2_STEP_QUOTA)return void n(!0,`${(null==r?void 0:r.message)||""}`);l.messageError=r.message}else l.messageError=pe.str("STR_ERROR_UNKNOWN")}}function d(){l.checkedItems.length>0&&(l.checkedItems=[])}return Object(h.useEffect)((()=>(s.current=window.setInterval((()=>{d()}),3e4),()=>{s.current&&window.clearInterval(s.current)})),[]),f.a.createElement("div",{className:"security-question-screen",style:{backgroundColor:"var(--layer-background)",zIndex:12}},f.a.createElement("div",{className:"title"},f.a.createElement("img",{draggable:!1,src:de.a,style:{height:"32px",alignSelf:"center"}}),f.a.createElement(ne.a,{textKey:"STR_LOGIN_ACCOUNT",style:{margin:"0",color:"var(--B95)",fontSize:"18px",fontWeight:"600",alignSelf:"center"},tagName:"div"}),f.a.createElement("span",{style:{margin:"0",color:"var(--B95)",fontSize:"14px",fontWeight:400,lineHeight:"20px",alignSelf:"center",textAlign:"center"}},`${c}`)),f.a.createElement("div",{className:"body"},f.a.createElement(ne.a,{className:Object(K.a)("error","text-center"),textKey:`${l.messageError}`}),f.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"230px",width:"100%",border:"1px solid var(--border)"}},f.a.createElement(He.a,{autoHide:!1},(null!==(i=e.choices)&&void 0!==i?i:[]).map((e=>f.a.createElement(Je,{key:"item_qs_"+e.value,id:e.value,thumb:e.thumb,title:e.title,onClick:e=>{!function(e){const t=l.checkedItems.indexOf(e);t>-1?l.checkedItems.splice(t,1):l.checkedItems.push(e),l.checkedItems=[...l.checkedItems]}(e)},checked:void 0!==l.checkedItems.find((t=>t===e.value))})))))),f.a.createElement("div",{className:"footer"},f.a.createElement(De.a,{disabled:l.checkedItems.length!==e.answerType,onClick:()=>{u()},size:"large",textKey:"STR_ANSWER",style:{width:"100%"}}),f.a.createElement(De.a,{type:"tertiary-primary",size:"large",textKey:"STR_BACK",onClick:n})))},Je=({id:e,onClick:t,thumb:n,title:o,checked:a})=>f.a.createElement("div",{className:Object(K.a)("rel","flx flx-al-c","security-question-screen__list-friend__item"),onClick:()=>{t(e)}},n&&f.a.createElement(ae.a,{userId:e,target:{displayName:o,avatar:n},size:"l"}),f.a.createElement("div",{className:Object(K.a)("name",n&&"ml-12")},o),f.a.createElement(Fe.b,{className:"fl-r",checked:a}));n("hGpA"),n("y65y");var Ze=n("Z8OR");const Ye=Object(h.forwardRef)((({className:e,style:t,textKey:n,inputProps:o,onChange:a,countryCode:r=84,phoneNumber:i="",countryIsoCode:c="VN"},s)=>{const l=Object(h.useRef)(null),[u,d]=Object(h.useState)(!1);return Object(h.useImperativeHandle)(s,(()=>l.current),[]),f.a.createElement("fieldset",{className:Object(K.a)(["input-phone-v2",null!=e?e:""]),style:t},f.a.createElement("div",{className:"iso-picker",onClick:()=>{d(!0)}},"+"+r,f.a.createElement(oe.a,{icon:"solid-down-1",style:{fontSize:"12px",corlor:"var(--icon-secondary)"}})),f.a.createElement("input",Object(Ue.a)({className:"phone",value:i,onChange:e=>{!function(e){let t=r,n=c,o=e.split("").filter((e=>e>="0"&&e<="9"||"+"===e)).join("").trim();if(o.startsWith("+")){const e=p.default.getPhoneNumber(o);e.isPossibleNumber()&&(t=e.getCountryCode(),n=e.getISOCountryCode(),o=e.getPhone())}a&&a({countryCode:t,countryIsoCode:n,phoneNumber:o})}(e.currentTarget.value)}},o,{ref:l,"data-translate-placeholder":n})),u&&f.a.createElement(Ze.a,{onCountrySelected:e=>{var t,n,o;(t=e)&&a&&a({countryCode:t.country_code,countryIsoCode:t.iso_country_code,phoneNumber:null!==(n=null===(o=l.current)||void 0===o?void 0:o.value)&&void 0!==n?n:""}),d(!1)},countries:[{country_code:93,iso_country_code:"AF",country_name:"Afghanistan"},{country_code:376,iso_country_code:"AD",country_name:"Andorra"},{country_code:244,iso_country_code:"AO",country_name:"Angola"},{country_code:1264,iso_country_code:"AI",country_name:"Anguilla"},{country_code:1268,iso_country_code:"AG",country_name:"Antigua and Barbuda"},{country_code:54,iso_country_code:"AR",country_name:"Argentina"},{country_code:297,iso_country_code:"AW",country_name:"Aruba"},{country_code:61,iso_country_code:"AU",country_name:"Australia"},{country_code:43,iso_country_code:"AT",country_name:"Austria"},{country_code:1242,iso_country_code:"BS",country_name:"Bahamas"},{country_code:973,iso_country_code:"BH",country_name:"Bahrain"},{country_code:880,iso_country_code:"BD",country_name:"Bangladesh"},{country_code:1246,iso_country_code:"BB",country_name:"Barbados"},{country_code:375,iso_country_code:"BY",country_name:"Belarus"},{country_code:32,iso_country_code:"BE",country_name:"Belgium"},{country_code:501,iso_country_code:"BZ",country_name:"Belize"},{country_code:229,iso_country_code:"BJ",country_name:"Benin"},{country_code:1441,iso_country_code:"BM",country_name:"Bermuda"},{country_code:975,iso_country_code:"BT",country_name:"Bhutan"},{country_code:591,iso_country_code:"BO",country_name:"Bolivia"},{country_code:387,iso_country_code:"BA",country_name:"Bosnia and Herzegovina"},{country_code:267,iso_country_code:"BW",country_name:"Botswana"},{country_code:55,iso_country_code:"BR",country_name:"Brazil"},{country_code:673,iso_country_code:"BN",country_name:"Brunei"},{country_code:359,iso_country_code:"BG",country_name:"Bulgaria"},{country_code:226,iso_country_code:"BF",country_name:"Burkina Faso"},{country_code:257,iso_country_code:"BI",country_name:"Burundi"},{country_code:855,iso_country_code:"KH",country_name:"Cambodia"},{country_code:237,iso_country_code:"CM",country_name:"Cameroon"},{country_code:1,iso_country_code:"CA",country_name:"Canada"},{country_code:1345,iso_country_code:"KY",country_name:"Cayman Islands"},{country_code:236,iso_country_code:"CF",country_name:"Central African Republic"},{country_code:235,iso_country_code:"TD",country_name:"Chad"},{country_code:56,iso_country_code:"CL",country_name:"Chile"},{country_code:86,iso_country_code:"CN",country_name:"China"},{country_code:269,iso_country_code:"KM",country_name:"Comoros"},{country_code:682,iso_country_code:"CK",country_name:"Cook Islands"},{country_code:506,iso_country_code:"CR",country_name:"Costa Rica"},{country_code:385,iso_country_code:"HR",country_name:"Croatia"},{country_code:53,iso_country_code:"CU",country_name:"Cuba"},{country_code:357,iso_country_code:"CY",country_name:"Cyprus"},{country_code:420,iso_country_code:"CZ",country_name:"Czech Republic"},{country_code:243,iso_country_code:"CD",country_name:"Democratic Republic of the Congo"},{country_code:45,iso_country_code:"DK",country_name:"Denmark"},{country_code:253,iso_country_code:"DJ",country_name:"Djibouti"},{country_code:1767,iso_country_code:"DM",country_name:"Dominica"},{country_code:1809,iso_country_code:"DO",country_name:"Dominican Republic"},{country_code:670,iso_country_code:"TL",country_name:"East Timor"},{country_code:593,iso_country_code:"EC",country_name:"Ecuador"},{country_code:20,iso_country_code:"EG",country_name:"Egypt"},{country_code:503,iso_country_code:"SV",country_name:"El Salvador"},{country_code:240,iso_country_code:"GQ",country_name:"Equatorial Guinea"},{country_code:372,iso_country_code:"EE",country_name:"Estonia"},{country_code:251,iso_country_code:"ET",country_name:"Ethiopia"},{country_code:298,iso_country_code:"FO",country_name:"Faroe Islands"},{country_code:679,iso_country_code:"FJ",country_name:"Fiji"},{country_code:358,iso_country_code:"FI",country_name:"Finland"},{country_code:33,iso_country_code:"FR",country_name:"France"},{country_code:220,iso_country_code:"GM",country_name:"Gambia"},{country_code:995,iso_country_code:"GE",country_name:"Georgia"},{country_code:49,iso_country_code:"DE",country_name:"Germany"},{country_code:233,iso_country_code:"GH",country_name:"Ghana"},{country_code:350,iso_country_code:"GI",country_name:"Gibraltar"},{country_code:30,iso_country_code:"GR",country_name:"Greece"},{country_code:299,iso_country_code:"GL",country_name:"Greenland"},{country_code:1473,iso_country_code:"GD",country_name:"Grenada"},{country_code:1671,iso_country_code:"GU",country_name:"Guam"},{country_code:502,iso_country_code:"GT",country_name:"Guatemala"},{country_code:224,iso_country_code:"GN",country_name:"Guinea"},{country_code:245,iso_country_code:"GW",country_name:"Guinea-Bissau"},{country_code:509,iso_country_code:"HT",country_name:"Haiti"},{country_code:504,iso_country_code:"HN",country_name:"Honduras"},{country_code:852,iso_country_code:"HK",country_name:"Hong Kong"},{country_code:36,iso_country_code:"HU",country_name:"Hungary"},{country_code:354,iso_country_code:"IS",country_name:"Iceland"},{country_code:91,iso_country_code:"IN",country_name:"India"},{country_code:62,iso_country_code:"ID",country_name:"Indonesia"},{country_code:98,iso_country_code:"IR",country_name:"Iran"},{country_code:964,iso_country_code:"IQ",country_name:"Iraq"},{country_code:353,iso_country_code:"IE",country_name:"Ireland"},{country_code:972,iso_country_code:"IL",country_name:"Israel"},{country_code:39,iso_country_code:"IT",country_name:"Italy"},{country_code:1876,iso_country_code:"JM",country_name:"Jamaica"},{country_code:81,iso_country_code:"JP",country_name:"Japan"},{country_code:44,iso_country_code:"JE",country_name:"Jersey"},{country_code:962,iso_country_code:"JO",country_name:"Jordan"},{country_code:7,iso_country_code:"KZ",country_name:"Kazakhstan"},{country_code:254,iso_country_code:"KE",country_name:"Kenya"},{country_code:686,iso_country_code:"KI",country_name:"Kiribati"},{country_code:965,iso_country_code:"KW",country_name:"Kuwait"},{country_code:996,iso_country_code:"KG",country_name:"Kyrgyzstan"},{country_code:856,iso_country_code:"LA",country_name:"Laos"},{country_code:371,iso_country_code:"LV",country_name:"Latvia"},{country_code:961,iso_country_code:"LB",country_name:"Lebanon"},{country_code:266,iso_country_code:"LS",country_name:"Lesotho"},{country_code:231,iso_country_code:"LR",country_name:"Liberia"},{country_code:218,iso_country_code:"LY",country_name:"Libya"},{country_code:423,iso_country_code:"LI",country_name:"Liechtenstein"},{country_code:370,iso_country_code:"LT",country_name:"Lithuania"},{country_code:352,iso_country_code:"LU",country_name:"Luxembourg"},{country_code:853,iso_country_code:"MO",country_name:"Macau"},{country_code:389,iso_country_code:"MK",country_name:"Macedonia"},{country_code:261,iso_country_code:"MG",country_name:"Madagascar"},{country_code:265,iso_country_code:"MW",country_name:"Malawi"},{country_code:60,iso_country_code:"MY",country_name:"Malaysia"},{country_code:960,iso_country_code:"MV",country_name:"Maldives"},{country_code:223,iso_country_code:"ML",country_name:"Mali"},{country_code:356,iso_country_code:"MT",country_name:"Malta"},{country_code:52,iso_country_code:"MX",country_name:"Mexico"},{country_code:691,iso_country_code:"FM",country_name:"Micronesia"},{country_code:373,iso_country_code:"MD",country_name:"Moldova"},{country_code:377,iso_country_code:"MC",country_name:"Monaco"},{country_code:976,iso_country_code:"MN",country_name:"Mongolia"},{country_code:382,iso_country_code:"ME",country_name:"Montenegro"},{country_code:1664,iso_country_code:"MS",country_name:"Montserrat"},{country_code:212,iso_country_code:"MA",country_name:"Morocco"},{country_code:258,iso_country_code:"MZ",country_name:"Mozambique"},{country_code:95,iso_country_code:"MM",country_name:"Myanmar"},{country_code:264,iso_country_code:"NA",country_name:"Namibia"},{country_code:977,iso_country_code:"NP",country_name:"Nepal"},{country_code:31,iso_country_code:"NL",country_name:"Netherlands"},{country_code:599,iso_country_code:"AN",country_name:"Netherlands Antilles"},{country_code:687,iso_country_code:"NC",country_name:"New Caledonia"},{country_code:64,iso_country_code:"NZ",country_name:"New Zealand"},{country_code:850,iso_country_code:"KP",country_name:"North Korea"},{country_code:47,iso_country_code:"NO",country_name:"Norway"},{country_code:968,iso_country_code:"OM",country_name:"Oman"},{country_code:970,iso_country_code:"PS",country_name:"Palestine"},{country_code:507,iso_country_code:"PA",country_name:"Panama"},{country_code:675,iso_country_code:"PG",country_name:"Papua New Guinea"},{country_code:595,iso_country_code:"PY",country_name:"Paraguay"},{country_code:51,iso_country_code:"PE",country_name:"Peru"},{country_code:63,iso_country_code:"PH",country_name:"Philippines"},{country_code:48,iso_country_code:"PL",country_name:"Poland"},{country_code:351,iso_country_code:"PT",country_name:"Portugal"},{country_code:1787,iso_country_code:"PR",country_name:"Puerto Rico"},{country_code:974,iso_country_code:"QA",country_name:"Qatar"},{country_code:242,iso_country_code:"CG",country_name:"Republic Of The Congo"},{country_code:262,iso_country_code:"RE",country_name:"RÃ©union Island"},{country_code:40,iso_country_code:"RO",country_name:"Romania"},{country_code:7,iso_country_code:"RU",country_name:"Russia"},{country_code:250,iso_country_code:"RW",country_name:"Rwanda"},{country_code:1869,iso_country_code:"KN",country_name:"Saint Kitts and Nevis"},{country_code:508,iso_country_code:"PM",country_name:"Saint Pierre and Miquelon"},{country_code:1784,iso_country_code:"VC",country_name:"Saint Vincent and The Grenadines"},{country_code:685,iso_country_code:"WS",country_name:"Samoa"},{country_code:239,iso_country_code:"ST",country_name:"Sao Tome and Principe"},{country_code:966,iso_country_code:"SA",country_name:"Saudi Arabia"},{country_code:221,iso_country_code:"SN",country_name:"Senegal"},{country_code:381,iso_country_code:"RS",country_name:"Serbia"},{country_code:248,iso_country_code:"SC",country_name:"Seychelles"},{country_code:232,iso_country_code:"SL",country_name:"Sierra Leone"},{country_code:65,iso_country_code:"SG",country_name:"Singapore"},{country_code:421,iso_country_code:"SK",country_name:"Slovakia"},{country_code:386,iso_country_code:"SI",country_name:"Slovenia"},{country_code:252,iso_country_code:"SO",country_name:"Somalia"},{country_code:27,iso_country_code:"ZA",country_name:"South Africa"},{country_code:82,iso_country_code:"KR",country_name:"South Korea"},{country_code:211,iso_country_code:"SS",country_name:"South Sudan"},{country_code:34,iso_country_code:"ES",country_name:"Spain"},{country_code:94,iso_country_code:"LK",country_name:"Sri Lanka"},{country_code:249,iso_country_code:"SD",country_name:"Sudan"},{country_code:597,iso_country_code:"SR",country_name:"Suriname"},{country_code:268,iso_country_code:"SZ",country_name:"Swaziland"},{country_code:46,iso_country_code:"SE",country_name:"Sweden"},{country_code:41,iso_country_code:"CH",country_name:"Switzerland"},{country_code:963,iso_country_code:"SY",country_name:"Syria"},{country_code:886,iso_country_code:"TW",country_name:"Taiwan"},{country_code:992,iso_country_code:"TJ",country_name:"Tajikistan"},{country_code:255,iso_country_code:"TZ",country_name:"Tanzania"},{country_code:66,iso_country_code:"TH",country_name:"Thailand"},{country_code:228,iso_country_code:"TG",country_name:"Togo"},{country_code:676,iso_country_code:"TO",country_name:"Tonga"},{country_code:1868,iso_country_code:"TT",country_name:"Trinidad and Tobago"},{country_code:216,iso_country_code:"TN",country_name:"Tunisia"},{country_code:90,iso_country_code:"TR",country_name:"Turkey"},{country_code:993,iso_country_code:"TM",country_name:"Turkmenistan"},{country_code:1649,iso_country_code:"TC",country_name:"Turks and Caicos Islands"},{country_code:256,iso_country_code:"UG",country_name:"Uganda"},{country_code:380,iso_country_code:"UA",country_name:"Ukraine"},{country_code:971,iso_country_code:"AE",country_name:"United Arab Emirates"},{country_code:44,iso_country_code:"GB",country_name:"United Kingdom"},{country_code:1,iso_country_code:"US",country_name:"United States"},{country_code:998,iso_country_code:"UZ",country_name:"Uzbekistan"},{country_code:58,iso_country_code:"VE",country_name:"Venezuela"},{country_code:84,iso_country_code:"VN",country_name:"Vietnam"},{country_code:1284,iso_country_code:"VG",country_name:"Virgin Islands British"},{country_code:967,iso_country_code:"YE",country_name:"Yemen"},{country_code:260,iso_country_code:"ZM",country_name:"Zambia"},{country_code:263,iso_country_code:"ZW",country_name:"Zimbabwe"}],countryCode:r,oftenCountries:[]}))}));var $e=n("NDmK");const et=({isFocusLoginNormal:e})=>{const t=j(),n=te({password:"",phoneNumber:"",countryCode:84,countryIsoCode:"VN",captcha:"",captchaToken:"",errorMessage:"",secQuestion:null,coutingFailureSubmited:0,isReloadCaptcha:!1,currentLanguage:pe.getCurrentLanguageName()||"vi"}),o=ee((()=>n.phoneNumber.length>=6&&n.password.length>=3&&n.captcha.length>0)),a=ee((()=>1!==$e.default.authentication.enable_content_notify_off_login_password?"":$e.default.authentication.content_notify_off_login_password[n.currentLanguage])),r=Object(h.useRef)(null),i=Object(h.useRef)(null),c=Object(h.useRef)(null);function s(e){t.stateMachine.handler(B.main_choose_login_qr),e&&(t.stateMachine.state.data={error_from_login_password:e}),t.loginSession.loginStateStream.next(t.stateMachine.state),n.captcha="",n.captchaToken="",n.password="",i.current&&(i.current.value=""),u(null)}function l(e){13===e.which&&(o.value&&d(),e.preventDefault())}function u(e){n.errorMessage=null!=e?e:""}async function d(e){var o;"activeElement"in document&&(null===(o=document.activeElement)||void 0===o||o.blur());try{t.loginSession.isLoading.next(!0);const o=await async function({phone:e,pass:t,captcha:n,captchaToken:o,imei:a,makeAnswer:r,answerData:i,country:c}){try{const _=Ke().getItem("quest_cert"),y=Ke().getItem("captcha_cert"),m=await he.default.signInPasswordV2(e,t,n,o,a,r,i,i?null:_,n?null:y,c.iso,pe.getCurrentLanguageName(),ze.a.getUidLogin(),null,null),h=Te(null==m?void 0:m.data);if("Right"===h._tag){var s,l,u,d,g;const t=h.value,n=null!==(s=null==t?void 0:t.uid)&&void 0!==s?s:"",o=null!==(l=null==t?void 0:t.dkey)&&void 0!==l?l:"";if(n&&o){const e=Object(ie.c)(n);Ke().init(n,o),e||Ke().setItemForCurrentUser(Ee().FirstLoginLocalStorageKeys.IS_FIRST_LOGIN,"1")}Ke().setItem(p.RECENT_PHONE,e),Ke().setItem(p.RECENT_COUNTRY,JSON.stringify(c));const a=!(null===(u=h.value)||void 0===u||!u.needSyncMsg)||!(null===(d=h.value)||void 0===d||!d.sync_msg_info);return Ke().setItem("z_needSyncMsg",a?"1":""),Ke().setItem(Ee().KEY_REMEMBER,Ie.a.getValueRememberLogin()?"1":""),Ke().setItem(Ee().KEY_SET_VALUE_ACTION_LOG,`${Ie.a.getValueActionLogRemember()}`),null!=t&&t.quest_cert&&Ke().setItem("quest_cert",t.quest_cert),null!=t&&t.cptch_cert&&Ke().setItem("captcha_cert",t.cptch_cert),Ke().setItem("FORCE_GET_FRIEND_LIST","1"),await $zelectron.setAppCookie(null!==(g=null==t?void 0:t.zpw_sek)&&void 0!==g?g:""),Ke().removeItem("FORGOT_PASSWORD"),null!=n?n:""}throw h.value}catch(_){if(_ instanceof Error&&"Network Error"===_.message)throw new we({code:"STR_CONNECTION_ERROR",message:"STR_CONNECTION_ERROR",name:"Network Error"});throw _}}({phone:n.phoneNumber,pass:n.password,captcha:n.captcha,captchaToken:n.captchaToken,imei:E(),makeAnswer:e?1:0,answerData:e||null,country:{code:n.countryCode,iso:n.countryIsoCode}});t.stateMachine.handler(B.main_accepted_login),t.stateMachine.state.data={typeLogin:Ee().LOGIN_TYPE_PASSWORD},t.loginSession.loginStateStream.next(t.stateMachine.state),t.loginSession.logInfoV2Stream.next({type:152404,subType:0,data:{authentication_status:!0,login_method:"password",uid:o}})}catch(a){if(n.isReloadCaptcha=!0,e)throw a;if(a instanceof we&&a.code===Oe.SECURITY_QUESTION_REQUIRED&&a.data)return n.secQuestion=We(a.data),t.stateMachine.state.error((function(e){return e[0]})`Require security question when login with password: ${a.code}`),void(a.data.cptch_cert&&Ke().setItem("captcha_cert",a.data.cptch_cert));if(t.loginSession.logInfoV2Stream.next({type:152404,subType:0,data:{authentication_status:!1,login_method:"password",error_code:(null==a?void 0:a.code)||(null==a?void 0:a.error_code)||a}}),t.stateMachine.state.error(`Submit login with password was failed: ${JSON.stringify(a)}`),n.isReloadCaptcha=!0,a instanceof we){if("string"==typeof a.code)return void u(pe.str("STR_SIGNIN_ERROR_NO_NETWORK"));a.code===Oe.OUT_OF_SECQ_QUOTA||a.code===Oe.OUT_OF_SECQ_2_STEP_QUOTA||a.code===Oe.SENSITIVE_FLOW_REQUIRE_OTP_OR_CONFIRM_MOBILE||a.code===Oe.SENSITIVE_FLOW_REQUIRE_OTP?u(a.message):[18041,18042,18043].includes(a.code)?u(a.message?a.message:pe.str("STR_SIGNIN_ERROR_RECYCLE_SIM")):18044===a.code?u(a.message?a.message:pe.str("STR_SIGNIN_ERROR_CHANGED_NUMPHONE")):u(a.message)}else u(pe.str("STR_ERROR_UNKNOWN"));n.coutingFailureSubmited++,3===n.coutingFailureSubmited&&(s("STR_LOGIN_PASSWORD_PAGE_ERROR_SUBMIT_TOO_MUCH"),n.coutingFailureSubmited=0)}finally{t.loginSession.isLoading.next(!1),n.isReloadCaptcha=!1}}return Object(h.useEffect)((()=>{var t;e&&(null===(t=r.current)||void 0===t||t.focus(),r.current&&(r.current.value="",n.phoneNumber=""))}),[e]),Object(h.useEffect)((()=>{const e=()=>{n.currentLanguage=pe.getCurrentLanguageName()};return pe.callUpdate(e),()=>{pe.removeUpdate(e)}}),[]),f.a.createElement(h.Fragment,null,f.a.createElement("form",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",flex:1,padding:"60px 32px 0px 32px",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"},onSubmit:e=>{e.preventDefault(),d()},ref:c},f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement("img",{draggable:!1,src:de.a,style:{height:"32px",alignSelf:"center"}}),f.a.createElement(ne.a,{textKey:"STR_LOGIN_PASSWORD_PAGE_TITLE",style:{margin:"0",color:"var(--text-primary)",fontSize:"18px",lineHeight:"24px",fontWeight:600,alignSelf:"center"},tagName:"div"}),a.value.length>0&&f.a.createElement(Pe.a,{style:{padding:"8px",backgroundColor:"var(--layer-information-background)",color:"var(--text-primary)",borderRadius:"6px"},status:"emphasis-info",alignment:"start",closable:!1,content:f.a.createElement("span",{style:{marginTop:"-2px",display:"inline-block"}},a.value),iconOptions:{size:20,alignment:"top",rounded:!0},maxContentLines:5,className:"system-banner-comp"})),f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement(Ye,{countryCode:n.countryCode,countryIsoCode:n.countryIsoCode,phoneNumber:n.phoneNumber,textKey:"STR_PHONE_NUMBER",onChange:({countryCode:e,countryIsoCode:t,phoneNumber:o})=>{var a;a={countryCode:e,countryIsoCode:t,phoneNumber:o},n.countryCode=a.countryCode,n.countryIsoCode=a.countryIsoCode.trim(),n.phoneNumber=a.phoneNumber.trim(),u(null)},inputProps:{placeholder:pe.str("STR_PHONE_NUMBER"),onKeyPress:e=>{l(e)}},ref:r}),f.a.createElement(qe,{textKey:"STR_PASSWORD",inputRef:e=>{i.current=e},domref:i,onKeyPress:e=>{l(e)},onChange:e=>{!function(e){n.password=e.target.value,u(null)}(e)},style:{width:"100%",boxSizing:"border-box",padding:"8px 0px 7px 0px",color:"var(--text-primary)",fontSize:"14px",lineHeight:"20px",fontWeight:400}}),f.a.createElement(Ge,{onChangeCaptcha:(e,t)=>{var o,a;o=e,a=t,n.captcha=o,n.captchaToken=a},onEnter:e=>{l(e)},isInit:e,isReset:n.isReloadCaptcha}),f.a.createElement("span",{className:"login-error-message"+(n.errorMessage?"":"--none"),style:{textAlign:"start",width:"100%",marginTop:"-8px"}},n.errorMessage)),f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"flex-start",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement(De.a,{textKey:"STR_SIGNIN",onClick:()=>{var e;null===(e=c.current)||void 0===e||e.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},disabled:!o.value,size:"large",style:{margin:"0",width:"100%"}}),f.a.createElement(ne.a,{textKey:"STR_SIGNIN_FORGET",tagName:"div",onClick:()=>(t.stateMachine.handler(B.main_forget_password),t.stateMachine.state.data={phoneNumber:n.phoneNumber,countryIsoCode:n.countryIsoCode,countryCode:n.countryCode},n.captcha="",n.captchaToken="",n.password="",i.current&&(i.current.value=""),u(null),void t.loginSession.loginStateStream.next(t.stateMachine.state)),style:{margin:"0",width:"fit-content",textAlign:"start",color:"var(--text-primary)",fontSize:"14px",lineHeight:"20px",fontWeight:400,cursor:"pointer"}})))),f.a.createElement("div",{style:{display:"flex",flexDirection:"row",padding:"16px 32px 16px 32px",gap:"10px",alignItems:"center",justifyContent:"center",boxSizing:"border-box"}},f.a.createElement(De.a,{size:"medium",textKey:"STR_LOGIN_PASSWORD_PAGE_BACK_QR",onClick:()=>{s()},type:"tertiary-neutral"})),null!==n.secQuestion&&f.a.createElement(Xe,{usedForResetPassword:!1,dataSecQues:n.secQuestion,onBack:(e,o)=>{e&&(s(),o&&t.loginSession.popupStream.next(f.a.createElement(Le.default,{visible:!0,showCloseButton:!1,idName:"noti-answer-security-too-much-when-reset-password",noPadding:!0,border:"no-border",title:pe.str("STR_CONFIG_NOTI"),style:{borderRadius:"8px",background:"transparent"},okText:pe.str("STR_CLOSE"),onOk:()=>{t.loginSession.popupStream.next(null)},preventPageClickForceClose:!1,message:o}))),n.secQuestion=null},onSubmit:d}))};const tt=({next:e})=>{var t,n,o,a;const r=j(),i=te({errorMessage:"",otp:"",secQuestion:null}),c=Object(h.useRef)(null),s=ee((()=>i.otp.length>0&&""===i.errorMessage));async function l(){try{var t,n,o,a;r.loginSession.isLoading.next(!0);const s=await async function({imei:e,phoneNumber:t,isoCode:n,otp:o,timeZone:a,language:r}){try{const y=await he.default.validateActiveCode(e,t,n,o,a,!0,3,{language:r}),m=Te(null==y?void 0:y.data);var i,c,s,l,u,d,g,_;if("Right"===m._tag)return Ke().setItem("FORGOT_PASSWORD","1"),{enk:null!==(i=null===(c=m.value)||void 0===c?void 0:c.enk)&&void 0!==i?i:"",question:null!==(s=null===(l=m.value)||void 0===l?void 0:l.question)&&void 0!==s?s:null,requireSEQ:null!==(u=null===(d=m.value)||void 0===d?void 0:d.requireSEQ)&&void 0!==u?u:0,token:null!==(g=null===(_=m.value)||void 0===_?void 0:_.token)&&void 0!==g?g:""};throw m.value}catch(y){if(y instanceof Error&&"Network Error"===y.message)throw new we({code:"STR_CONNECTION_ERROR",message:"STR_CONNECTION_ERROR",name:"Network Error"});throw y}}({imei:E(),isoCode:null!==(t=null===(n=r.stateMachine.state.data)||void 0===n?void 0:n.countryIsoCode)&&void 0!==t?t:"VN",otp:i.otp,phoneNumber:null!==(o=null===(a=r.stateMachine.state.data)||void 0===a?void 0:a.phoneNumber)&&void 0!==o?o:"",timeZone:Ve(),language:pe.getCurrentLanguageName()});if(s.token&&(r.stateMachine.state.data.authToken=s.token),s.enk&&(c=s.enk,p.default.setDecryptKey(c)),1===s.requireSEQ)return i.secQuestion=We(s.question),void r.stateMachine.state.noti("Verify otp successfully but required security question");r.stateMachine.state.noti("Verify otp successfully"),e()}catch(s){r.stateMachine.state.error(`Verify otp was failed: ${JSON.stringify(s)}`),s instanceof we?"string"==typeof(null==s?void 0:s.code)?i.errorMessage=pe.str(s.code):18025===(null==s?void 0:s.code)?i.errorMessage=pe.str("STR_SIGNIN_ERROR_INVALID_PHONE_NUMBER"):i.errorMessage=s.message:i.errorMessage=pe.str("STR_ERROR_UNKNOWN")}finally{r.loginSession.isLoading.next(!1)}var c}return Object(h.useEffect)((()=>{var e;return null===(e=c.current)||void 0===e||e.focus(),c.current&&c.current.addEventListener("input",(function(){var e;this.value=this.value.replace(/[^0-9]/g,""),e=this.value,i.otp=e,i.errorMessage=""})),()=>{var e,t;null===(e=c.current)||void 0===e||e.blur(),null===(t=c.current)||void 0===t||t.removeEventListener("input",(()=>{}))}}),[c.current]),f.a.createElement(h.Fragment,null,f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement(ne.a,{textKey:"STR_RESET_PASSWORD_PAGE_INSTRUCTION_SEND_SMS",style:{margin:"0",color:"var(--B95)",fontSize:"14px",fontWeight:"400",lineHeight:"20px",alignSelf:"center",textAlign:"center"},tagName:"div"}),f.a.createElement("input",{className:"forget-password-page__input-otp",required:!0,type:"text",ref:c,onKeyDown:function(e){13==e.which&&(s.value&&l(),e.preventDefault())},"data-translate-placeholder":"STR_ACTIVATION_CODE",placeholder:pe.str("STR_ACTIVATION_CODE")}),f.a.createElement("span",{className:"login-error-message"+(i.errorMessage?"":"--none"),style:{marginTop:"-8px"}},i.errorMessage)),f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement(De.a,{textKey:"STR_CONTINUE",onClick:()=>{l()},disabled:!s.value,size:"large","data-id":"btn_forget_password_verify_otp",style:{margin:"0",width:"100%"}})),null!==i.secQuestion&&f.a.createElement(Xe,{usedForResetPassword:!0,dataUser:{isoCode:null!==(t=null===(n=r.stateMachine.state.data)||void 0===n?void 0:n.countryIsoCode)&&void 0!==t?t:"84",token:r.stateMachine.state.data.authToken||"",phone:null!==(o=null===(a=r.stateMachine.state.data)||void 0===a?void 0:a.phoneNumber)&&void 0!==o?o:"0"},dataSecQues:i.secQuestion,onBack:(e,t)=>{i.secQuestion=null,e&&t&&(r.stateMachine.state.error(`Answer security question failed: ${t}`),r.loginSession.popupStream.next(f.a.createElement(Le.default,{visible:!0,showCloseButton:!1,idName:"noti-answer-security-too-much-when-reset-password",noPadding:!0,border:"no-border",title:pe.str("STR_CONFIG_NOTI"),style:{borderRadius:"8px",background:"transparent"},okText:pe.str("STR_CLOSE"),onCloseConfirm:()=>{r.loginSession.popupStream.next(null)},preventPageClickForceClose:!1,message:t})))},onSubmit:async t=>{r.stateMachine.state.data.answerData=t,r.stateMachine.state.noti("Answer security question successfully"),e()}}))};const nt=({submit:e})=>{const t=Object(h.useRef)(null),n=Object(h.useRef)(null),o=j(),a=te({errorMessage:"",rules:[]});async function r(){(function(e){let t=!0;a.errorMessage="";for(let o=0;o<a.rules.length;o++)if(t=t&&RegExp(a.rules[o].regex).test(e),!t){var n;if(a.errorMessage=null!==(n=a.rules[o]["vi"===pe.getCurrentLanguageName()?"msg":"msg_en"])&&void 0!==n?n:"",""!==a.errorMessage)break;t=!0}return t})(t.current.value)&&function(e){let n=!0;return e===t.current.value?a.errorMessage="":(a.errorMessage=pe.str("STR_CONFORM_PW_NOT_MATCH"),n=!1),n}(n.current.value)&&(o.loginSession.isLoading.next(!0),async function({phoneNumber:e,countryCode:t,isoCode:n,password:o,rePassword:a,authToken:r,timeZone:i,imei:c,language:s,answerData:l}){try{const m=await he.default.loginByResetPassword(e,c,p.default.encodeAES(`${o}`.trim()),p.default.encodeAES(`${a}`.trim()),r,i,n,s,l),h=Te(null==m?void 0:m.data);if("Right"!==h._tag)throw h.value;var u,d,g;if(!(null!==(u=h.value)&&void 0!==u&&u.quest_cert||null!==(d=h.value)&&void 0!==d&&d.zpw_sek))throw new we({});if(null!==(g=h.value)&&void 0!==g&&g.zpw_sek){var _,y;const o=h.value,a=null!==(_=null==o?void 0:o.uid)&&void 0!==_?_:"",r=null!==(y=null==o?void 0:o.dkey)&&void 0!==y?y:"";if(a&&r){const e=Object(ie.c)(a);Ke().init(a,r),e||Ke().setItemForCurrentUser(Ee().FirstLoginLocalStorageKeys.IS_FIRST_LOGIN,"1")}const i={code:t,iso:n};return Ke().setItem(p.RECENT_PHONE,e),Ke().setItem(p.RECENT_COUNTRY,JSON.stringify(i)),Ke().setItem(Ee().KEY_REMEMBER,Ie.a.getValueRememberLogin()?"1":""),Ke().setItem(Ee().KEY_SET_VALUE_ACTION_LOG,`${Ie.a.getValueActionLogRemember()}`),Ke().setItem("FORCE_GET_FRIEND_LIST","1"),await $zelectron.setAppCookie(o.zpw_sek),Ke().removeItem("FORGOT_PASSWORD"),a}}catch(m){if(m instanceof Error&&"Network Error"===m.message)throw new we({code:"STR_CONNECTION_ERROR",message:"STR_CONNECTION_ERROR",name:"Network Error"});throw m}throw new we({})}({imei:E(),countryCode:o.stateMachine.state.data.countryCode,isoCode:o.stateMachine.state.data.countryIsoCode,phoneNumber:o.stateMachine.state.data.phoneNumber,password:t.current.value,rePassword:n.current.value,authToken:o.stateMachine.state.data.authToken,language:pe.getCurrentLanguageName(),timeZone:Ve(),answerData:o.stateMachine.state.data.answerData||null}).then((t=>{o.stateMachine.state.noti("Submit login by new password successfully"),e(t)})).catch((e=>{o.stateMachine.state.error(`Submit login by new password was failed: ${JSON.stringify(e)}`),e instanceof we?"string"==typeof(null==e?void 0:e.code)?a.errorMessage=pe.str(e.code):a.errorMessage=e.message:a.errorMessage=pe.str("STR_ERROR_UNKNOWN"),o.loginSession.logInfoV2Stream.next({type:152404,subType:0,data:{authentication_status:!1,login_method:"recover_password",error_code:(null==e?void 0:e.code)||(null==e?void 0:e.error_code)||e}})})).finally((()=>{o.loginSession.isLoading.next(!1)})))}return Object(h.useEffect)((()=>{o.loginSession.isLoading.next(!0),async function(e){try{return await p.default.getPasswordRules(e,he.default)||[]}catch(t){throw t}}(E()).then((e=>{o.stateMachine.state.error((function(e){return e[0]})`Get rule update password successfully`),a.rules=e})).catch((e=>{o.stateMachine.state.error(`Get rule update password failed: ${JSON.stringify(e)}`)})).finally((()=>{var e;o.loginSession.isLoading.next(!1),null===(e=t.current)||void 0===e||e.focus()}))}),[]),f.a.createElement(h.Fragment,null,f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement(ne.a,{textKey:"STR_RESET_PASSWORD_PAGE_NOTE_DESCRIPTION_NEW_PASSWORD",style:{textAlign:"center"}}),f.a.createElement(qe,{textKey:"STR_NEW_PASSWORD",inputRef:e=>{t.current=e},domRef:t.current,onChange:()=>{a.errorMessage=""},onKeyPress:e=>{!function(e){13==e.which&&(""===a.errorMessage&&r(),e.preventDefault())}(e)},style:{width:"100%",boxSizing:"border-box",padding:"8px 0px"}}),f.a.createElement(qe,{textKey:"STR_CONFIRM_NEW_PASSWORD",inputRef:e=>{n.current=e},domRef:n.current,onChange:()=>{a.errorMessage=""},onKeyPress:e=>{!function(e){13==e.which&&(""===a.errorMessage&&r(),e.preventDefault())}(e)},style:{width:"100%",boxSizing:"border-box",padding:"8px 0px"}}),f.a.createElement("span",{className:"login-error-message"+(a.errorMessage?"":"--none"),style:{width:"100%",textAlign:"start",marginTop:"-8px"}},a.errorMessage)),f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement(De.a,{textKey:"STR_LOGIN_PASSWORD_PAGE_SUBMIT_NEW_PASSWORD",onClick:()=>{r()},disabled:""!==a.errorMessage,size:"large","data-id":"btn_forget_password_verify_phone",style:{margin:"0",width:"100%"}})))};const ot=({next:e})=>{var t,n,o,a,r,i,c,s;const l=Object(h.useRef)(null),u=j(),d=te({phoneNumber:null!==(t=null===(n=u.stateMachine.state.data)||void 0===n?void 0:n.phoneNumber)&&void 0!==t?t:"",countryCode:null!==(o=null===(a=u.stateMachine.state.data)||void 0===a?void 0:a.countryCode)&&void 0!==o?o:84,countryIsoCode:null!==(r=null===(i=u.stateMachine.state.data)||void 0===i?void 0:i.countryIsoCode)&&void 0!==r?r:"VN",enableNext:(null!==(c=null===(s=u.stateMachine.state.data)||void 0===s?void 0:s.phoneNumber)&&void 0!==c?c:"").length>=6,errorMessage:""});async function g(){try{var t;u.loginSession.isLoading.next(!0),await async function({imei:e,phoneNumber:t,isoCode:n,language:o,context:a=2,captchaAnswer:r="",captchaToken:i=null,activeType:c=1}){try{const s={language:o,context:a,captchaToken:i,captchaAnswer:r},l=await he.default.verifyPhoneNumber(e,t,n,c,s),u=Te(null==l?void 0:l.data);if("Right"===u._tag)return;throw u.value}catch(s){if(s instanceof Error&&"Network Error"===s.message)throw new we({code:"STR_CONNECTION_ERROR",message:"STR_CONNECTION_ERROR",name:"Network Error"});throw s}}({imei:E(),isoCode:null!==(t=d.countryIsoCode)&&void 0!==t?t:"VN",language:pe.getCurrentLanguageName(),phoneNumber:d.phoneNumber}),u.stateMachine.state.data={phoneNumber:d.phoneNumber,countryCode:d.countryCode,countryIsoCode:d.countryIsoCode},u.stateMachine.state.noti("Verify phone number successfully"),e()}catch(n){u.stateMachine.state.error(`Verify phone number was failed: ${JSON.stringify(n)}`),n instanceof we?"string"==typeof(null==n?void 0:n.code)?d.errorMessage=pe.str(n.code):n.code===Oe.REJECTED_OTP?(u.stateMachine.state.data={phoneNumber:d.phoneNumber,countryCode:d.countryCode,countryIsoCode:d.countryIsoCode},e()):d.errorMessage=pe.str("STR_SIGNIN_ERROR_INVALID_PHONE_NUMBER"):d.errorMessage=pe.str("STR_ERROR_UNKNOWN")}finally{u.loginSession.isLoading.next(!1)}}return Object(h.useEffect)((()=>{var e;return null===(e=l.current)||void 0===e||e.focus(),()=>{var e;null===(e=l.current)||void 0===e||e.blur()}}),[l.current]),f.a.createElement(h.Fragment,null,f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement(ne.a,{textKey:"STR_ENTER_PHONE_FOR_ACTIVATION_CODE",style:{margin:"0",color:"var(--B95)",fontSize:"14px",fontWeight:"400",lineHeight:"20px",alignSelf:"center",textAlign:"center"},tagName:"div"}),f.a.createElement(Ye,{countryCode:d.countryCode,countryIsoCode:d.countryIsoCode,phoneNumber:d.phoneNumber,textKey:"STR_PHONE_NUMBER",onChange:({countryCode:e,countryIsoCode:t,phoneNumber:n})=>{var o;o={countryCode:e,countryIsoCode:t,phoneNumber:n},d.errorMessage="",d.phoneNumber=o.phoneNumber,d.countryIsoCode=o.countryIsoCode,d.countryCode=o.countryCode,d.enableNext=d.phoneNumber.length>=6},inputProps:{placeholder:pe.str("STR_PHONE_NUMBER"),onKeyPress:e=>{!function(e){13==e.which&&(d.enableNext&&g(),e.preventDefault())}(e)}},ref:l}),f.a.createElement("span",{className:"login-error-message"+(d.errorMessage?"":"--none"),style:{marginTop:"-8px",width:"100%",textAlign:"start"}},d.errorMessage)),f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",gap:"16px",alignItems:"center",justifyContent:"flex-start",boxSizing:"border-box"}},f.a.createElement(De.a,{textKey:"STR_CONTINUE",onClick:()=>{g()},disabled:!d.enableNext||""!==d.errorMessage,size:"large","data-id":"btn_forget_password_verify_phone",style:{margin:"0",width:"100%"}})))};n("36dD");const at=()=>{const e=j(),t=te({step:"idle"});function n(){e.stateMachine.handler(B.main_choose_login_normal),e.stateMachine.state.data={phoneNumber:"",countryIsoCode:"VN",countryCode:84,authToken:""},e.loginSession.loginStateStream.next(e.stateMachine.state),t.step="idle"}return Object(h.useEffect)((()=>{"idle"===t.step&&e.stateMachine.state.key===z.ForgetPassword?t.step="verify-phone":e.stateMachine.state.key!==z.ForgetPassword&&"idle"!==t.step&&(t.step="idle")}),[t.step,e.stateMachine.state]),f.a.createElement(h.Fragment,null,f.a.createElement("div",{className:"forget-password-page"},f.a.createElement("div",{className:"title"},f.a.createElement("img",{draggable:!1,src:de.a,style:{height:"32px",alignSelf:"center"}}),"idle"!==t.step&&f.a.createElement(ne.a,{textKey:(()=>{switch(t.step){case"verify-phone":return"STR_PASSWORD_RECOVERY";case"required-otp":return"STR_VERIFY_ACCOUNT";case"setup-password":return"STR_UPDATE_LOGIN_PASSWORD"}})(),style:{margin:"0",color:"var(--text-primary)",fontSize:"18px",lineHeight:"24px",fontWeight:600,alignSelf:"center"},tagName:"div"})),f.a.createElement("div",{className:"body"},"verify-phone"===t.step&&f.a.createElement(ot,{next:()=>{t.step="required-otp"}}),"required-otp"===t.step&&f.a.createElement(tt,{next:()=>{t.step="setup-password"}}),"setup-password"===t.step&&f.a.createElement(nt,{submit:t=>{var n;n=t,e.stateMachine.state.data=null,e.stateMachine.handler(B.main_accepted_login),e.stateMachine.state.data={typeLogin:Ee().LOGIN_TYPE_PASSWORD},e.loginSession.loginStateStream.next(e.stateMachine.state),e.loginSession.logInfoV2Stream.next({type:152404,subType:0,data:{authentication_status:!0,login_method:"recover_password",uid:n}})}}))),f.a.createElement("div",{className:"forget-password-page__footer"},f.a.createElement(De.a,{size:"medium",textKey:"STR_CANCEL",onClick:()=>{"setup-password"===t.step?e.loginSession.popupStream.next(f.a.createElement(Le.default,{visible:!0,showCloseButton:!0,idName:"noti-user-really-want-to-cancel-change-password-modal",noPadding:!0,border:"no-border",style:{borderRadius:"8px",background:"transparent"},okText:pe.str("STR_DISCARD"),okType:"secondary-danger",cancelText:pe.str("STR_CLOSE"),onOk:()=>{n()},onCloseConfirm:()=>{e.loginSession.popupStream.next(null)},preventPageClickForceClose:!0,message:pe.str("STR_DISCARD_RESET_PW")})):n()},className:"footer-btn",type:"tertiary-neutral"})))};n("47Cz");const rt=0,it=1,ct=()=>{const[e,t]=f.a.useState(rt),n=Object(h.useRef)(null);function o(){n.current=window.setTimeout((()=>{t(it)}),12e4)}return f.a.useEffect((()=>(o(),()=>{null!==n.current&&clearTimeout(n.current)})),[]),e===rt?f.a.createElement("div",{className:"network-comp--no-network-banner"},f.a.createElement(oe.a,{icon:"outline-disconnect",style:{color:"var(--text-primary)"}}),f.a.createElement(ne.a,{tagName:"div",textKey:"STR_INFO_NO_NETWORK",style:{color:"var(--text-primary)"}})):f.a.createElement("div",{className:"network-comp--no-network-screen"},f.a.createElement("div",{className:"body"},f.a.createElement("img",{draggable:!1,src:de.a,style:{height:"32px",alignSelf:"center"}}),f.a.createElement("div",{className:"content"},f.a.createElement(oe.a,{icon:"icon-disconnect",style:{color:"var(--icon-secondary)",fontSize:"68px"}}),f.a.createElement("span",{style:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center",width:"100%",maxWidth:"356px"}},f.a.createElement(ne.a,{textKey:"STR_CANT_CONNECT_1",tagName:"div",style:{fontSize:"1.125rem",fontWeight:500,lineHeight:"1.5",textAlign:"center"}}),f.a.createElement(ne.a,{textKey:"STR_CANT_CONNECT_3",tagName:"div",style:{fontSize:"0.875rem",fontWeight:400,lineHeight:"1.5",textAlign:"center"}})))),f.a.createElement("div",{className:"footer"},f.a.createElement(De.a,{type:"tertiary-neutral",size:"medium",textKey:"STR_BACK_TO_LOGIN",onClick:function(){t(rt),o()}})))};var st=()=>{const[e,t]=Object(h.useState)(null),n=Object(h.useCallback)((()=>{const t=new Date(e.startTime),n=new Date(e.endTime),o=e=>e.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),a=e=>e.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),r=o(t),i=a(t),c=o(n),s=a(n);return i===s?`${r} - ${c}, ${s}`:`${r}, ${i} - ${c}, ${s}`}),[e]);Object(h.useEffect)((()=>{let e=-1;const n=Object(m.c)().listenMaintenanceMode((n=>{const o=Date.now();if(n.serverMaintenanceData&&n.serverMaintenanceData.startTime>o){t(n.serverMaintenanceData);const a=n.serverMaintenanceData.startTime-o;e=window.setTimeout((()=>{Object(m.c)().restartApp(),window.clearTimeout(e)}),a-1e3)}else t(null)}));return()=>{window.clearTimeout(e),n()}}),[]);return{show:!!e,renderComponent:e=>f.a.createElement(Pe.a,{status:"warning",alignment:"center",closable:!1,content:f.a.createElement(f.a.Fragment,null,f.a.createElement(ne.a,{style:{fontSize:null!=e?e:"inherit"},className:"truncate",textKey:"STR_BANNER_WARNING_MAINTENANCE_MODE"}),f.a.createElement("span",{style:{fontSize:null!=e?e:"inherit"},className:"z-banner__info__title truncate"},` ${n()}`)),iconOptions:{size:0},maxContentLines:1,className:"system-banner-comp"})}};n("t3EU");const lt=()=>{const e=j(),t=st(),n=te({loginStateKey:e.stateMachine.state.key,isNoNetwork:!window.navigator.onLine});return Object(h.useEffect)((()=>{e.loginSession.loginStateStream.subscribe((e=>{e&&(n.loginStateKey=e.key)})),p.default.checkNetwork((t=>{n.isNoNetwork=!t,e.stateMachine.state.error("Internet status change: "+(t?"Connected":"Disconnected"))}))}),[]),f.a.createElement("div",{className:"login-layout"},f.a.createElement("div",{style:{height:"fit-content",position:"absolute",width:"100%",top:"40px",display:n.isNoNetwork||t.show&&!n.isNoNetwork?"block":"none"},className:Object(K.a)(["wrap-loss-network",n.isNoNetwork||t.show&&!n.isNoNetwork?"slideInDown":"slideOutUp"])},n.isNoNetwork&&f.a.createElement(ct,null),t.show&&!n.isNoNetwork&&t.renderComponent("12px")),f.a.createElement("div",{key:"LoginQRPage",style:{display:n.loginStateKey===z.LoginQR?"flex":"none"},className:Object(K.a)(["login-page-wrap",""+(n.loginStateKey===z.LoginQR?"login-page-wrap__animation--show":"login-page-wrap__animation--hide")])},f.a.createElement(ke,null)),e.enableEntryLoginPassword&&f.a.createElement("div",{key:"LoginNormalPage",style:{display:n.loginStateKey===z.LoginNormal?"flex":"none"},className:Object(K.a)(["login-page-wrap",""+(n.loginStateKey===z.LoginNormal?"login-page-wrap__animation--show":"login-page-wrap__animation--hide")])},f.a.createElement(et,{isFocusLoginNormal:n.loginStateKey===z.LoginNormal})),e.enableEntryLoginPassword&&f.a.createElement("div",{key:"ForgetPasswordPage",style:{display:n.loginStateKey===z.ForgetPassword?"flex":"none"},className:Object(K.a)(["login-page-wrap",""+(n.loginStateKey===z.ForgetPassword?"login-page-wrap__animation--show":"login-page-wrap__animation--hide")])},f.a.createElement(at,null)),f.a.createElement("div",{key:"LoginSuccessPage",style:{display:n.loginStateKey===z.LoginSuccess?"flex":"none"}}))};var ut=n("MEZx");const dt=({country:e})=>f.a.createElement("span",{className:"emoji-sizer emoji-outer ",style:{background:`url(${$e.default.emojiImg})`,backgroundSize:"6500%",backgroundPosition:$e.default.emojiMapPos[`:flag-${e}:`],WebkitUserSelect:"none",marginLeft:"5px",verticalAlign:"text-bottom",height:"18px"}});var gt=n("IjM+");n("w4sY");const _t=({platform:e,handlerCloseAppOnWindowOS:t,openAppInfo:n,submitQoSLog:o,isSubmittingQoSLog:a,loginWithPassword:r,handlerMinimiseAppWindowOS:i,enableBadgeMenu:c})=>{const s=Object(h.useRef)(null),l=Object(h.useRef)(null),u=te({languageSelected:ye.a.currentLanguage(),isShowMenu:!1,adminConfig:"",enableBadgeMenu:c});function d(e){var t;ye.a.changeToLang(e),u.languageSelected=e,$zapp.changeLanguage(ye.a.getCurrentLanguageName()),null===(t=s.current)||void 0===t||t.close(null)}return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"login-title-bar"},"WIN32"===e&&f.a.createElement("div",null,f.a.createElement("i",{className:"fa fa-Minus_24_Line login-title-bar__hide-icon",onClick:e=>{e.stopPropagation(),i()}}),f.a.createElement("i",{className:"fa fa-Close_24_Line login-title-bar__close-icon",onClick:e=>{e.stopPropagation(),t()}}))),f.a.createElement("div",{className:"login-title-bar__setting-button",style:{right:"DARWIN"===e?0:void 0,left:"DARWIN"===e?void 0:0}},f.a.createElement(De.a,{icon:"icon-outline-menu",type:"tertiary-neutral",size:"large",ref:e=>{l.current=e},onClick:e=>{var t;null===(t=s.current)||void 0===t||t.show(e,l.current)},isActive:u.isShowMenu,style:{padding:"0"}}),u.enableBadgeMenu&&f.a.createElement(gt.a,{style:{position:"absolute",top:"8px",left:"DARWIN"===e?"8px":void 0,right:"DARWIN"===e?void 0:"8px"}})),f.a.createElement(ut.default,{popoverProps:{identity:{windowId:w.c,name:Se.PopoverIdentitiesDefine.SWITCH_LANGUAGE}},ref:s,onShow:()=>{u.isShowMenu=!0},onClose:()=>{u.isShowMenu=!1,Ke().setItem("z_press_menu_button_with_badge","1"),u.enableBadgeMenu=!1},items:[{type:ut.MENU_ITEM_TYPE.SUBMENU,textKey:"STR_MENU_LANGUAGE",items:[{text:"Tiáº¿ng Viá»t",icon:{html:f.a.createElement(dt,{country:"vn"})},onclick:()=>{d(Se.LANG_INDEX_VI)},checked:u.languageSelected===Se.LANG_INDEX_VI},{text:"English",icon:{html:f.a.createElement(dt,{country:"us"})},onclick:()=>{d(Se.LANG_INDEX_EN)},checked:u.languageSelected===Se.LANG_INDEX_EN}]},{textKey:"STR_ABOUT",onclick:()=>{n()}},...r?[{textKey:"STR_LOGIN_PASSWORD_PAGE_TITLE",onclick:()=>{r()},rightIcon:u.enableBadgeMenu?{html:f.a.createElement(gt.a,{style:{position:"absolute",top:"16px",left:void 0,right:"16px"}})}:void 0}]:[],...$e.default.submit_log_conf.enable?[{textKey:"STR_MENU_SUBMITLOG",onclick:o,disabled:a}]:[]]}))};function yt(){var e;return null!==(e=Ke().getItem("zlast_uid"))&&void 0!==e?e:""}var mt=n("6LLQ");const pt="screen-old-app",ht={Root:pt,Container:`${pt}__container`,Logo:`${pt}__logo`,Title:`${pt}__title`,Btn:`${pt}__btn`},ft=()=>f.a.createElement("div",{className:`flx flx-col ${ht.Root}`},f.a.createElement("img",{src:de.a,className:ht.Logo}),f.a.createElement("img",{src:mt.a}),f.a.createElement(ne.a,{textKey:"STR_SCREEN_OLD_APP_TITLE",tagName:"div",className:ht.Title}),f.a.createElement(ne.a,{textKey:"STR_SCREEN_OLD_APP_DESC",tagName:"div"}),f.a.createElement(De.a,{textKey:"STR_SCREEN_OLD_APP_DOWNLOAD_NEW",onClick:()=>{$zupdater.openUpdatePage()},size:"large",className:ht.Btn}));var St=()=>{const{appVersionState:e}=Object(k.a)(),t=j(),n=te({loginStateKey:t.stateMachine.state.key,popup:null,isLoading:!1,isSubmittingLog:!1});function o(e,n){n&&n.forceFallback?t.loginSession.popupStream.next(f.a.createElement(R.default,{info:n,cancel:()=>{t.loginSession.popupStream.next(null)}})):t.loginSession.popupStream.next(f.a.createElement(N.default,{info:n,cancel:()=>{t.loginSession.popupStream.next(null)}}))}function a(e,t){t&&function(e){P.g.setRecentUpdate(e)}(t)}function i(){t.loginSession.popupStream.next(f.a.createElement(b.a,{cancel:()=>{t.loginSession.popupStream.next(null)}}))}function c(){t.loginSession.logInfoV2Stream.next({type:152406,subType:0,data:{}});const e=document.getElementById("login-splash-screen");e&&(e.style.display="flex"),C.default.logAction(117241),C.default._log(),window.setTimeout((()=>{r.ModuleContainer.resolve(L.a).requestQuitApp()}),600)}return Object(h.useEffect)((()=>{var e,r;t.dropServerConfig&&t.stateMachine.state.error("Drop server config"),t.loginSession.loginStateStream.subscribe((e=>{if(e){if(n.loginStateKey=e.key,e.key===z.LoginSuccess.toString()){var o;const e=document.getElementById("login-splash-screen");e&&(e.style.display="flex"),t.loginSession.popupStream.next(null),Ke().setItem("z_reclogtype",null===(o=t.stateMachine.state.data)||void 0===o?void 0:o.typeLogin),t.stateMachine.loginQrState.state.key!==U.TimeoutQR&&t.loginSession.loginQrStateStream.next(t.stateMachine.loginQrState.handler(B.qr_timeout)),setTimeout((()=>{t.loginSession.notiLoginSuccess()}),600)}e.key===z.LoginNormal.toString()&&t.loginSession.logInfoV2Stream.next({type:152403,subType:0,data:{has_previous_account:yt().length>0}})}})),t.loginSession.loginStateStream.next(t.stateMachine.handler(B.main_choose_login_qr)),t.loginSession.popupStream.subscribe((e=>{e&&(n.popup=null),n.popup=e})),t.loginSession.isLoading.subscribe((e=>{e?n.isLoading=e:setTimeout((()=>{n.isLoading=e||!1}),600)}));const c=null!==(e=Ke().getItem("z_session_expired_14days"))&&void 0!==e?e:"";return t.loginSession.logInfoV2Stream.subscribe((e=>{const n=Object(I.a)({},(null!=e?e:{}).data);if(c&&(n.login_source="session_timeout_14day"),e){switch(!0){case!0===t.enableEntryLoginPassword:n.login_version="password_and_qr";break;case!1===t.enableEntryLoginPassword:n.login_version="qr_only"}n.device_imei=E(),n.session_id=t.sessionId,e.data=n,M.default.increaseSuccess(e.type,0,10,[JSON.stringify(n)]),152404===e.type&&n.authentication_status&&M.default.flush()}})),t.loginSession.logInfoV2Stream.next({type:152401,subType:0,data:{last_uid:yt()}}),t.loginSession.logInfoV2Stream.next({type:152408,subType:0,data:{last_uid:yt()}}),null!==(r=window.$zenv)&&void 0!==r&&r.isPreloaded&&($zsub.$zupdater.onNewUpdate(a),$zsub.$zupdater.onNewManualUpdate(a),$zsub.$zupdater.onFallbackUpdate(o)),$zlogin.onRequestShowAbout(i),()=>{t.loginSession.dispose()}}),[]),n.loginStateKey===z.Idle.toString()||n.loginStateKey===z.LoginSuccess.toString()||e===D.a.NONE?f.a.createElement(f.a.Fragment,null):f.a.createElement("div",{id:"app-page",style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",boxSizing:"border-box",backgroundColor:"var(--layer-background)"}},f.a.createElement(_t,{handlerCloseAppOnWindowOS:()=>{c()},handlerMinimiseAppWindowOS:()=>{$zwindow.minimize(w.c)},platform:"DARWIN",openAppInfo:()=>{i()},submitQoSLog:()=>{n.isSubmittingLog=!0,x.a.submitLogManually().then((()=>{O.ZToastManagerHolder.getZToastManagerByWindowId(w.c).show({noBackground:!0,textKey:"STR_MENU_SUBMITLOG_SUCCESS",type:O.TOAST_TYPE.SUCCESS})})).catch((e=>{O.ZToastManagerHolder.getZToastManagerByWindowId(w.c).show({noBackground:!0,textKey:"STR_SUBMITLOG_FAIL",type:O.TOAST_TYPE.ERROR})})).finally((()=>{n.isSubmittingLog=!1}))},isSubmittingQoSLog:n.isSubmittingLog,loginWithPassword:t.enableEntryLoginPassword&&n.loginStateKey===z.LoginQR&&e===D.a.VERIFIED?()=>{try{t.loginSession.loginStateStream.next(t.stateMachine.handler(B.main_choose_login_normal))}catch(e){t.stateMachine.state.error(`Can not switch to login password screen: ${e}`)}}:void 0,enableBadgeMenu:t.enableBadgeSettingButton}),f.a.createElement(A.a,null,e===D.a.VERIFIED?f.a.createElement(lt,null):f.a.createElement(ft,null)),f.a.createElement(A.a,null,Object(S.createPortal)(n.popup,document.body,"popup")),f.a.createElement(T.b,{windowId:w.c}),Object(S.createPortal)(n.isLoading&&f.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",boxSizing:"border-box",position:"fixed",left:0,top:0,justifyContent:"center",alignItems:"center",backdropFilter:"blur(8px)",backgroundColor:"rgba(255, 255, 255, 0.3)"}},f.a.createElement("img",{draggable:!1,src:ue})),document.body,"loading-retry-get-config-server"))};class vt{constructor(e,t){if(this.dataCenterId=void 0,this.workerId=void 0,this.sequence=0,this.lastTimestamp=-1,e<0||e>vt.MAX_DATA_CENTER_ID)throw new Error(`Data center ID must be between 0 and ${vt.MAX_DATA_CENTER_ID}`);if(t<0||t>vt.MAX_WORKER_ID)throw new Error(`Worker ID must be between 0 and ${vt.MAX_WORKER_ID}`);this.dataCenterId=e,this.workerId=t}generateId(){let e=Date.now()-vt.EPOCH;if(e<this.lastTimestamp)throw new Error("Clock moved backwards. Refusing to generate id.");if(e===this.lastTimestamp){if(this.sequence=this.sequence+1&vt.MAX_SEQUENCE,0===this.sequence)for(;e<=this.lastTimestamp;)e=Date.now()-vt.EPOCH}else this.sequence=0;this.lastTimestamp=e;return(BigInt(e)<<BigInt(vt.TIMESTAMP_SHIFT)|BigInt(this.dataCenterId)<<BigInt(vt.DATA_CENTER_ID_SHIFT)|BigInt(this.workerId)<<BigInt(vt.WORKER_ID_SHIFT)|BigInt(this.sequence)).toString()}}vt.EPOCH=13437792e5,vt.TIMESTAMP_BITS=41,vt.DATA_CENTER_ID_BITS=5,vt.WORKER_ID_BITS=5,vt.SEQUENCE_BITS=12,vt.MAX_DATA_CENTER_ID=(1<<vt.DATA_CENTER_ID_BITS)-1,vt.MAX_WORKER_ID=(1<<vt.WORKER_ID_BITS)-1,vt.MAX_SEQUENCE=(1<<vt.SEQUENCE_BITS)-1,vt.WORKER_ID_SHIFT=vt.SEQUENCE_BITS,vt.DATA_CENTER_ID_SHIFT=vt.SEQUENCE_BITS+vt.WORKER_ID_BITS,vt.TIMESTAMP_SHIFT=vt.SEQUENCE_BITS+vt.WORKER_ID_BITS+vt.DATA_CENTER_ID_BITS;class Et{constructor(){this.key=void 0,this.value=void 0}}class It extends Et{constructor(){super(),this.key=void 0,this.value=void 0,this.observer=void 0,this.key=Symbol(new vt(0,1).generateId()),this.value=null,this.observer=new Map}subscribe(e){this.observer.set(e.getName(),e)}unsubcrise(e){this.observer.delete(e.getName())}close(){this.observer.clear()}notify(){this.observer.forEach((e=>{e.update(this)}))}}class Nt{constructor(){this.key=void 0}}class Rt extends Nt{constructor(e){super(),this.key=void 0,this.handler=void 0,this.key=Symbol(new vt(0,0).generateId()),this.handler=e}getName(){return this.key.toString()}update(e){e instanceof Et&&this.handler&&this.handler(e.value)}}class At{constructor(){this.key=void 0,this.subject=void 0,this.closed=!1,this.key=Symbol(new vt(0,2).generateId()),this.subject=new It}next(e){this.closed||(this.subject.value=e,this.subject.notify())}subscribe(e){const t=new Rt(e);if(!this.closed)return this.subject.subscribe(t),()=>{this.subject.unsubcrise(t)};throw Error("This stream is closed, no longer can be subcrise")}complete(){this.closed||(this.subject.close(),this.closed=!0)}}class bt{constructor(){this.key=void 0,this.loginStateStream=void 0,this.loginQrStateStream=void 0,this.isLoading=void 0,this.popupStream=void 0,this.logInfoV2Stream=void 0,this.key=Symbol("LoginSessionService"),this.loginStateStream=new At,this.loginQrStateStream=new At,this.isLoading=new At,this.popupStream=new At,this.logInfoV2Stream=new At}getName(){var e;return null!==(e=this.key.description)&&void 0!==e?e:""}notiLoginSuccess(){return $zlogin.notifyLoginSuccess()}dispose(){this.loginStateStream.complete(),this.loginQrStateStream.complete(),this.popupStream.complete(),this.isLoading.complete(),this.logInfoV2Stream.complete()}}const wt=r.ModuleContainer.resolve(_.ZLoggerFactory).createZLogger(["login-v2"]);n("xNPa");function Tt(e){if(e.config_option_remember){let t=e.config_option_remember;["number","string"].includes(typeof t)&&("string"==typeof t&&(t=parseInt(t)),!isNaN(t)&&t>=0&&t<=2&&(Ke().setItem(Ee().KEY_CONFIG_OPTION_REMEMBER,t),Ke().setItem(Ee().KEY_CONFIG_NEW_REMEMBER,t)))}if(e.sentry_config){n("2ua2").default.saveSentryConfig(e.sentry_config)}e.auto_relaunch_mode&&e.auto_relaunch_timeout}const Ct=["enableEntryLoginPassword","enableBadgeSettingButton","dropServerConfig","autoUpdater"];var Mt=e=>{let{enableEntryLoginPassword:t,enableBadgeSettingButton:n,dropServerConfig:o,autoUpdater:a}=e,r=Object(v.a)(e,Ct);const{maintenanceMode:i}=Object(m.d)({isLoginScreen:!0});function c(){return{imei:E(),installerType:"unknown",autoUpdaterConfig:a}}Object(h.useEffect)((()=>(window.addEventListener("mouseup",(e=>{3!==e.button&&4!==e.button||e.preventDefault()})),$zresource.onRequestImei(c),()=>{window.removeEventListener("mouseup",(()=>{})),$zresource.removeListenRequestImei(c)})),[]);const s=Object(h.useMemo)((()=>{return e=e=>f.a.createElement(St,e),a={token:"login-v2",loginSession:new bt,stateMachine:new F("production",wt),enableEntryLoginPassword:t,dropServerConfig:o,sessionId:new vt(0,3).generateId(),enableBadgeSettingButton:n},t=>f.a.createElement(Q.Provider,{value:a},f.a.createElement(e,t));var e,a}),[]);return null===i?f.a.createElement(m.a,null):i?f.a.createElement(m.b,null):f.a.createElement(s,r)},xt=n("YGiT"),Ot=n("ZwwW"),kt=n("HuPi");n("U96N"),new Promise((async e=>{let t=!0;try{var o,a,r,i,c,s,l,u,d,g,_,y,h,f;Object(xt.a)();n("2ua2").default.init();p.default.checkSupport();const S=null!==(o=fe.default.getInstance().getItem("viewerkey"))&&void 0!==o?o:"",v=!!fe.default.getInstance().getItem("z_press_menu_button_with_badge");x.a.init({viewerkey:S,type:$e.default.apiType,version:$e.default.apiVersion,apiUrl:""}),await Object(m.c)().getServerInfoCheck();const E=Ot.b.getServerConfig();E&&(Tt(E),M.default.startQoSNotLogged()),t=!1;const I={enable_entry_login_pw:null!==(a=null===(r=$e.default.authentication)||void 0===r||null===(i=r.login_scr)||void 0===i?void 0:i.enable_entry_login_pw)&&void 0!==a?a:0,flag_login_gr_has_uid:null!==(c=null===(s=$e.default.authentication)||void 0===s||null===(l=s.login_scr)||void 0===l?void 0:l.flag_login_gr_has_uid)&&void 0!==c?c:0,flag_login_gr_non_uid:null!==(u=null===(d=$e.default.authentication)||void 0===d||null===(g=d.login_scr)||void 0===g?void 0:g.flag_login_gr_non_uid)&&void 0!==u?u:0,enable_badge_login_pw:null!==(_=null===(y=$e.default.authentication)||void 0===y||null===(h=y.login_scr)||void 0===h?void 0:h.enable_badge_login_pw)&&void 0!==_?_:0};if(S&&I.flag_login_gr_has_uid){const n=!!I.enable_entry_login_pw;return e({enableEntryLoginPassword:n,dropServerConfig:t,enableBadgeSettingButton:!!n&&(!!I.enable_badge_login_pw&&!v)})}if(!S&&null!==(f=I.flag_login_gr_non_uid)&&void 0!==f&&f){const n=!!I.enable_entry_login_pw;return e({enableEntryLoginPassword:n,dropServerConfig:t,enableBadgeSettingButton:!!n&&(!!I.enable_badge_login_pw&&!v)})}}catch(S){t=!0,Object(m.c)().getServerInfoCheck().then((()=>{Tt(Ot.b.getServerConfig()),M.default.startQoSNotLogged()}))}return e({enableEntryLoginPassword:!0,enableBadgeSettingButton:!1,dropServerConfig:t})})).then((e=>{fe.default.getInstance().setItem("z_loginversion","2"),Object(S.render)([f.a.createElement(kt.a,{_window:window}),f.a.createElement(Mt,{enableBadgeSettingButton:e.enableBadgeSettingButton,enableEntryLoginPassword:e.enableEntryLoginPassword,dropServerConfig:e.dropServerConfig,autoUpdater:$e.default.auto_updater})],document.getElementById("app"))})).catch((()=>{fe.default.getInstance().setItem("z_loginversion","2"),Object(S.render)([f.a.createElement(kt.a,{_window:window}),f.a.createElement(Mt,{enableBadgeSettingButton:!1,enableEntryLoginPassword:!0,dropServerConfig:!0,autoUpdater:$e.default.auto_updater})],document.getElementById("app"))})).finally((()=>{requestAnimationFrame((()=>{const e=document.getElementById("login-splash-screen");e&&(e.style.display="none")}))}));n("B3nq"),n("Ppsz");var Dt,Lt=n("wH4e"),Pt=(n("69Uf"),n("+eUS")),Qt=(n("uiYo"),n("Q97H"));Object(r.singleton)(L.a)(Dt=class{requestQuitApp(){this.doQuitApp()}requestRelaunch(){}doQuitApp(){Qt.a.clearSessionBeforeQuit(),Qt.a.closeDB($zapp.requestQuitAppImmediately)}});n("pQlW");Object(Pt.a)(Lt.i.Host)}}]);
//# sourceMappingURL=../sourcemaps/lazy/login-startup.ab280153c1d8df156d42.js.map